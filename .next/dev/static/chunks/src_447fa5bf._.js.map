{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/achra/proyectos/app-hotel-nueva/src/lib/supabaseClient.ts"],"sourcesContent":["// src/lib/supabaseClient.ts\r\n\r\nimport { createClient } from \"@supabase/supabase-js\";\r\n\r\n// ------------------------------------------------------------\r\n// ‚≠ê Validaci√≥n estricta de variables de entorno\r\n// ------------------------------------------------------------\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\r\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\r\n\r\nif (\r\n  !supabaseUrl ||\r\n  !supabaseAnonKey ||\r\n  supabaseUrl === \"undefined\" ||\r\n  supabaseAnonKey === \"undefined\" ||\r\n  supabaseUrl === \"null\" ||\r\n  supabaseAnonKey === \"null\"\r\n) {\r\n  throw new Error(\r\n    \"‚ùå Supabase environment variables are missing or invalid. Check NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY.\"\r\n  );\r\n}\r\n\r\n// ------------------------------------------------------------\r\n// ‚≠ê Crear cliente Supabase (modo frontend con sesi√≥n persistente)\r\n// ------------------------------------------------------------\r\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey, {\r\n  auth: {\r\n    persistSession: true,        // ‚Üê NECESARIO para login\r\n    autoRefreshToken: true,      // ‚Üê refresca tokens autom√°ticamente\r\n    detectSessionInUrl: true,    // ‚Üê necesario para magic links / OAuth\r\n  },\r\n});\r\n\r\n// ------------------------------------------------------------\r\n// (Opcional) Log controlado solo en desarrollo\r\n// ------------------------------------------------------------\r\nif (process.env.NODE_ENV === \"development\") {\r\n  console.log(\"üîå Supabase client initialized\");\r\n}\r\n"],"names":[],"mappings":";;;;AAOoB;AAPpB,4BAA4B;AAE5B;;AAEA,+DAA+D;AAC/D,gDAAgD;AAChD,+DAA+D;AAC/D,MAAM;AACN,MAAM;AAEN;;AAgBO,MAAM,WAAW,IAAA,iMAAY,EAAC,aAAa,iBAAiB;IACjE,MAAM;QACJ,gBAAgB;QAChB,kBAAkB;QAClB,oBAAoB;IACtB;AACF;AAEA,+DAA+D;AAC/D,+CAA+C;AAC/C,+DAA+D;AAC/D,wCAA4C;IAC1C,QAAQ,GAAG,CAAC;AACd"}},
    {"offset": {"line": 39, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/achra/proyectos/app-hotel-nueva/src/components/Gallery.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useEffect, useMemo, useState } from 'react';\r\nimport { createClient } from '@supabase/supabase-js';\r\nimport { useRouter } from 'next/navigation';\r\n\r\nconst supabase = createClient(\r\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\r\n);\r\n\r\n/* ============================\r\n   CONFIG\r\n============================ */\r\ntype TagObj = { label: string; score: number };\r\n\r\nconst MIN_SCORE = 0.6;\r\n\r\nconst CATEGORY_TAG_MAP: Record<string, string[]> = {\r\n  exterior: ['exterior', 'garden', 'parking', 'terrace', 'balcony', 'view', 'facade'],\r\n  habitaciones: [\r\n    'hotel room',\r\n    'family room',\r\n    'suite',\r\n    'double room',\r\n    'single room',\r\n    'king bed',\r\n    'queen bed',\r\n    'bedroom'\r\n  ],\r\n  interior: ['bathroom', 'corridor', 'hallway', 'interior'],\r\n  salas_comunes: ['lobby', 'reception', 'hall', 'common area', 'breakfast area'],\r\n  restaurante: ['restaurant', 'bar'],\r\n  piscina: ['swimming pool', 'pool'],\r\n  spa: ['spa', 'gym'],\r\n  otros: []\r\n};\r\n\r\nconst CATEGORY_LABELS: Record<string, string> = {\r\n  exterior: 'Exterior',\r\n  habitaciones: 'Habitaciones',\r\n  interior: 'Interior',\r\n  salas_comunes: 'Salas comunes',\r\n  restaurante: 'Restaurante',\r\n  piscina: 'Piscina',\r\n  spa: 'Spa',\r\n  otros: 'Otros'\r\n};\r\n\r\nconst CATEGORY_BUTTONS: Array<{ label: string; value: string | null }> = [\r\n  { label: 'Todas', value: null },\r\n  { label: 'Exterior', value: 'exterior' },\r\n  { label: 'Habitaciones', value: 'habitaciones' },\r\n  { label: 'Interior', value: 'interior' },\r\n  { label: 'Salas comunes', value: 'salas_comunes' },\r\n  { label: 'Restaurante', value: 'restaurante' },\r\n  { label: 'Piscina', value: 'piscina' },\r\n  { label: 'Spa', value: 'spa' },\r\n  { label: 'Otros', value: 'otros' }\r\n];\r\n\r\nconst qualityLabel = (score?: number) => {\r\n  if (typeof score !== 'number') return 'Media';\r\n  if (score >= 0.85) return 'Alta';\r\n  if (score >= 0.65) return 'Media';\r\n  return 'Baja';\r\n};\r\n\r\nconst norm = (s: string) => (s ?? '').toString().trim().toLowerCase();\r\n\r\nconst looksLikeJson = (s: string) => {\r\n  const t = s.trim();\r\n  return (t.startsWith('{') && t.endsWith('}')) || (t.startsWith('[') && t.endsWith(']'));\r\n};\r\n\r\nexport default function Gallery({\r\n  media = [],\r\n  hotelId: propHotelId,\r\n  onMediaChange = () => {}\r\n}: {\r\n  media?: any[];\r\n  hotelId?: string;\r\n  onMediaChange?: () => void;\r\n}) {\r\n  const [selectedCategory, setSelectedCategory] = useState<string | null>(null);\r\n  const [hoveredCard, setHoveredCard] = useState<string | null>(null);\r\n\r\n  const [uploading, setUploading] = useState(false);\r\n  const [selectedFile, setSelectedFile] = useState<File | null>(null);\r\n  const [uploadError, setUploadError] = useState<string | null>(null);\r\n  const [uploadSuccess, setUploadSuccess] = useState(false);\r\n\r\n  const [selectedImage, setSelectedImage] = useState<any>(null);\r\n  const [showDeleteModal, setShowDeleteModal] = useState(false);\r\n  const [imageToDelete, setImageToDelete] = useState<{ id: string; url: string } | null>(null);\r\n\r\n  const [localHotelId, setLocalHotelId] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (propHotelId) setLocalHotelId(propHotelId);\r\n  }, [propHotelId]);\r\n\r\n  const normalizeTags = (raw: any): TagObj[] => {\r\n    if (!raw) return [];\r\n    if (typeof raw === 'string') {\r\n      try {\r\n        return normalizeTags(JSON.parse(raw));\r\n      } catch {\r\n        return [];\r\n      }\r\n    }\r\n    if (Array.isArray(raw)) {\r\n      if (raw.length > 0 && typeof raw[0] === 'string') {\r\n        const out: TagObj[] = [];\r\n        for (const s of raw as string[]) {\r\n          const str = (s ?? '').toString().trim();\r\n          if (!str) continue;\r\n          if (looksLikeJson(str)) {\r\n            try {\r\n              const parsed = JSON.parse(str);\r\n              if (parsed && typeof parsed === 'object' && !Array.isArray(parsed)) {\r\n                const label = norm(parsed.label ?? parsed.tag ?? '');\r\n                if (!label) continue;\r\n                const score = typeof parsed.score === 'number' ? parsed.score : typeof parsed.confidence === 'number' ? parsed.confidence : 1;\r\n                out.push({ label, score });\r\n                continue;\r\n              }\r\n              if (Array.isArray(parsed)) {\r\n                out.push(...normalizeTags(parsed));\r\n                continue;\r\n              }\r\n            } catch {\r\n              // fallthrough\r\n            }\r\n          }\r\n          out.push({ label: norm(str), score: 1 });\r\n        }\r\n        return out.filter(t => t.label);\r\n      }\r\n      if (raw.length > 0 && typeof raw[0] === 'object') {\r\n        return (raw as any[])\r\n          .map(t => {\r\n            const label = norm(typeof t?.label === 'string' ? t.label : typeof t?.tag === 'string' ? t.tag : '');\r\n            if (!label) return null;\r\n            const score = typeof t?.score === 'number' ? t.score : typeof t?.confidence === 'number' ? t.confidence : 1;\r\n            return { label, score };\r\n          })\r\n          .filter(Boolean) as TagObj[];\r\n      }\r\n    }\r\n    return [];\r\n  };\r\n\r\n  const getDisplayCategory = (img: any) => {\r\n    const backendCategory = norm(img?.category);\r\n    if (backendCategory && backendCategory !== 'otros') return backendCategory;\r\n    const tags: TagObj[] = img?.tagsNormalized || [];\r\n    if (!tags.length) return 'otros';\r\n    let bestCategory: string | null = null;\r\n    let bestScore = -1;\r\n    for (const [category, labels] of Object.entries(CATEGORY_TAG_MAP)) {\r\n      if (category === 'otros') continue;\r\n      const allowed = labels.map(norm);\r\n      const score = Math.max(...tags.filter(t => allowed.includes(norm(t.label))).map(t => t.score), -1);\r\n      if (score > bestScore) {\r\n        bestScore = score;\r\n        bestCategory = category;\r\n      }\r\n    }\r\n    return bestCategory || 'otros';\r\n  };\r\n\r\n  const parsedMedia = useMemo(() => {\r\n    return (media || []).map(item => {\r\n      let versions = item?.versions;\r\n      if (versions && typeof versions === 'string') {\r\n        try {\r\n          versions = JSON.parse(versions);\r\n        } catch {\r\n          // keep as-is\r\n        }\r\n      }\r\n      const rawTags = item?.tags ?? item?.confidence_scores ?? item?.confidenceScores;\r\n      return {\r\n        ...item,\r\n        versions,\r\n        tagsNormalized: normalizeTags(rawTags),\r\n        ai_title: item?.ai_title || item?.title\r\n      };\r\n    });\r\n  }, [media]);\r\n\r\n  const sortedMedia = useMemo(() => {\r\n    return [...parsedMedia].sort((a, b) => {\r\n      const dateA = new Date(a.created_at).getTime();\r\n      const dateB = new Date(b.created_at).getTime();\r\n      return dateB - dateA;\r\n    });\r\n  }, [parsedMedia]);\r\n\r\n  const filteredImages = useMemo(() => {\r\n    if (!selectedCategory) return sortedMedia;\r\n    return sortedMedia.filter(img => {\r\n      const category = getDisplayCategory(img);\r\n      return category === selectedCategory;\r\n    });\r\n  }, [sortedMedia, selectedCategory]);\r\n\r\n  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0];\r\n    if (!file) return;\r\n    if (!file.type.startsWith('image/')) {\r\n      setUploadError('Solo se permiten im√°genes');\r\n      return;\r\n    }\r\n    if (file.size > 5 * 1024 * 1024) {\r\n      setUploadError('La imagen es demasiado grande (max. 5MB)');\r\n      return;\r\n    }\r\n    setSelectedFile(file);\r\n    setUploadError(null);\r\n  };\r\n\r\n  const handleUpload = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (!selectedFile || !localHotelId) {\r\n      setUploadError('Selecciona una imagen y aseg√∫rate de tener un hotel');\r\n      return;\r\n    }\r\n    setUploading(true);\r\n    setUploadError(null);\r\n    setUploadSuccess(false);\r\n    try {\r\n      const formData = new FormData();\r\n      formData.append('file', selectedFile);\r\n      formData.append('hotel_id', localHotelId);\r\n      const response = await fetch('/api/upload', { method: 'POST', body: formData });\r\n      const result = await response.json();\r\n      if (!response.ok) throw new Error(result.error || 'Error al subir imagen');\r\n      setUploadSuccess(true);\r\n      setSelectedFile(null);\r\n      setTimeout(() => setUploadSuccess(false), 1500);\r\n      onMediaChange();\r\n    } catch (err: any) {\r\n      setUploadError(err.message);\r\n    } finally {\r\n      setUploading(false);\r\n    }\r\n  };\r\n\r\n  const requestDelete = (id: string, url: string) => {\r\n    setImageToDelete({ id, url });\r\n    setShowDeleteModal(true);\r\n  };\r\n\r\n  const confirmDelete = async () => {\r\n    if (!imageToDelete) return;\r\n    try {\r\n      const fileName = imageToDelete.url.split('/').pop();\r\n      await supabase.storage.from('media').remove([fileName!]);\r\n      await supabase.from('media').delete().eq('id', imageToDelete.id);\r\n      onMediaChange();\r\n    } catch (err) {\r\n      console.error('Error al eliminar imagen:', err);\r\n      alert('Error al eliminar la imagen. Int√©ntalo de nuevo.');\r\n    } finally {\r\n      setShowDeleteModal(false);\r\n      setImageToDelete(null);\r\n    }\r\n  };\r\n\r\n  const handleDownload = async (url: string, filename: string) => {\r\n    try {\r\n      const response = await fetch(url);\r\n      const blob = await response.blob();\r\n      const blobUrl = URL.createObjectURL(blob);\r\n      const a = document.createElement('a');\r\n      a.href = blobUrl;\r\n      a.download = filename;\r\n      document.body.appendChild(a);\r\n      a.click();\r\n      document.body.removeChild(a);\r\n      URL.revokeObjectURL(blobUrl);\r\n    } catch (error) {\r\n      console.error('Error al descargar la imagen:', error);\r\n      alert('Error al descargar la imagen. Int√©ntalo de nuevo.');\r\n    }\r\n  };\r\n\r\n  const renderDownloadTable = (versions: any) => {\r\n    if (!versions) return null;\r\n    const originalDimensions = versions.original?.dimensions;\r\n    let originalWidth = 0;\r\n    let originalHeight = 0;\r\n    if (originalDimensions) {\r\n      const [w, h] = originalDimensions.split('x').map(Number);\r\n      originalWidth = w;\r\n      originalHeight = h;\r\n    }\r\n    const validVersions = Object.entries(versions)\r\n      .filter(([size, details]: [string, any]) => {\r\n        if (size === 'original') return true;\r\n        if (!details?.dimensions) return false;\r\n        const [w, h] = details.dimensions.split('x').map(Number);\r\n        return w <= originalWidth && h <= originalHeight;\r\n      })\r\n      .sort((a, b) => {\r\n        const order = ['thumbnail', 'small', 'medium', 'large', 'original'];\r\n        return order.indexOf(a[0]) - order.indexOf(b[0]);\r\n      });\r\n    return (\r\n      <div className=\"mt-6\">\r\n        <h4 className=\"text-sm font-medium text-gray-700 mb-3\">Opciones de descarga</h4>\r\n        <div className=\"bg-white rounded-xl shadow-sm overflow-hidden border border-gray-200\">\r\n          <div className=\"overflow-x-auto\">\r\n            <table className=\"min-w-full divide-y divide-gray-200 table-fixed\">\r\n              <thead className=\"bg-gray-50\">\r\n                <tr>\r\n                  <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-1/4\">\r\n                    Descripci√≥n\r\n                  </th>\r\n                  <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-1/4\">\r\n                    Dimensiones\r\n                  </th>\r\n                  <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-1/4\">\r\n                    Relaci√≥n\r\n                  </th>\r\n                  <th className=\"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider w-1/4\">\r\n                    Acciones\r\n                  </th>\r\n                </tr>\r\n              </thead>\r\n              <tbody className=\"bg-white divide-y divide-gray-200\">\r\n                {validVersions.map(([size, details]: [string, any]) => (\r\n                  <tr key={size} className=\"hover:bg-gray-50\">\r\n                    <td className=\"px-4 py-4 whitespace-nowrap text-sm font-medium text-gray-900 truncate\">\r\n                      {size === 'thumbnail' ? 'Miniatura' : \r\n                       size === 'small' ? 'Peque√±o' : \r\n                       size === 'medium' ? 'Mediano' : \r\n                       size === 'large' ? 'Grande' : 'Original'}\r\n                    </td>\r\n                    <td className=\"px-4 py-4 whitespace-nowrap text-sm text-gray-500 truncate\">\r\n                      {details.dimensions}\r\n                    </td>\r\n                    <td className=\"px-4 py-4 whitespace-nowrap text-sm text-gray-500 truncate\">\r\n                      {details.aspect_ratio}\r\n                    </td>\r\n                    <td className=\"px-4 py-4 whitespace-nowrap text-right text-sm font-medium\">\r\n                      <div className=\"flex justify-end gap-2\">\r\n                        {/* ‚úÖ BOT√ìN DE DESCARGA CON ICONO ELEGANTE */}\r\n                        <button\r\n                          onClick={() => handleDownload(details.url, `${size}-${Date.now()}.jpg`)}\r\n                          className=\"inline-flex items-center justify-center w-9 h-9 rounded-lg text-blue-600 bg-blue-50 hover:bg-blue-100 transition-colors shadow-sm hover:shadow-md\"\r\n                          title=\"Descargar\"\r\n                        >\r\n                          <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\" />\r\n                          </svg>\r\n                        </button>\r\n                        \r\n                        {/* ‚úÖ BOT√ìN DE VER CON ICONO ELEGANTE */}\r\n                        <a\r\n                          href={details.url}\r\n                          target=\"_blank\"\r\n                          rel=\"noopener noreferrer\"\r\n                          className=\"inline-flex items-center justify-center w-9 h-9 rounded-lg text-gray-500 hover:text-gray-700 hover:bg-gray-100 transition-colors shadow-sm hover:shadow\"\r\n                          title=\"Ver imagen\"\r\n                        >\r\n                          <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\r\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\r\n                          </svg>\r\n                        </a>\r\n                      </div>\r\n                    </td>\r\n                  </tr>\r\n                ))}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      {/* SECCI√ìN DE SUBIDA */}\r\n      <div className=\"mb-8 bg-white rounded-xl shadow-sm p-6 border border-gray-100\">\r\n        <div className=\"flex items-center mb-4\">\r\n          <div className=\"w-8 h-8 rounded-lg bg-blue-50 flex items-center justify-center mr-3\">\r\n            <svg className=\"w-5 h-5 text-blue-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z\" />\r\n            </svg>\r\n          </div>\r\n          <h3 className=\"text-lg font-semibold text-gray-900\">Subir Nueva Imagen</h3>\r\n        </div>\r\n        <input type=\"file\" id=\"image-upload\" className=\"hidden\" accept=\"image/jpeg, image/png, image/webp\" onChange={handleFileChange} />\r\n        <label htmlFor=\"image-upload\" className=\"w-full cursor-pointer flex items-center justify-center p-4 border-2 border-dashed border-gray-300 rounded-xl bg-gray-50 hover:border-gray-400 transition\">\r\n          <span className=\"text-gray-700 text-sm font-medium\">Seleccionar archivo</span>\r\n        </label>\r\n        {selectedFile && (\r\n          <div className=\"mt-3 flex items-center justify-between p-3 bg-gray-50 rounded-lg border\">\r\n            <div>\r\n              <p className=\"text-sm font-medium text-gray-900\">{selectedFile.name}</p>\r\n              <p className=\"text-xs text-gray-500\">{(selectedFile.size / 1024).toFixed(1)} KB</p>\r\n            </div>\r\n            <button onClick={() => setSelectedFile(null)} className=\"text-gray-400 hover:text-gray-600\">√ó</button>\r\n          </div>\r\n        )}\r\n        {uploadError && <div className=\"mt-3 p-3 bg-red-50 text-red-600 text-sm rounded-lg\">{uploadError}</div>}\r\n        {uploadSuccess && <div className=\"mt-3 p-3 bg-green-50 text-green-600 text-sm rounded-lg\">¬°Imagen subida y analizada con √©xito!</div>}\r\n        <button\r\n          onClick={handleUpload}\r\n          disabled={!selectedFile || uploading || !localHotelId}\r\n          className={`w-full mt-4 py-3.5 rounded-xl text-white font-medium transition-all ${\r\n            !selectedFile || uploading || !localHotelId ? 'bg-blue-500 opacity-50 cursor-not-allowed' : 'bg-blue-500 hover:bg-blue-600 hover:shadow-md'\r\n          }`}\r\n        >\r\n          {uploading ? 'Procesando...' : 'Subir y Analizar con IA'}\r\n        </button>\r\n      </div>\r\n\r\n      {/* CATEGOR√çAS */}\r\n      <div className=\"mb-6\">\r\n        <div className=\"flex flex-wrap gap-2\">\r\n          {CATEGORY_BUTTONS.map(cat => {\r\n            const isActive = selectedCategory === cat.value || (cat.value === null && selectedCategory === null);\r\n            return (\r\n              <button\r\n                key={cat.label}\r\n                onClick={() => setSelectedCategory(cat.value)}\r\n                className={`px-4 py-2 rounded-full text-sm font-medium transition border ${\r\n                  isActive ? 'bg-blue-600 text-white border-blue-600' : 'bg-gray-200 text-gray-700 border-gray-300 hover:bg-gray-300'\r\n                }`}\r\n              >\r\n                {cat.label}\r\n              </button>\r\n            );\r\n          })}\r\n        </div>\r\n      </div>\r\n\r\n      {/* GALER√çA */}\r\n      {filteredImages.length === 0 ? (\r\n        <div className=\"text-center py-12 text-gray-500\">\r\n          {selectedCategory ? 'No hay im√°genes para esta categor√≠a' : 'No hay im√°genes disponibles. ¬°Sube tu primera imagen!'}\r\n        </div>\r\n      ) : (\r\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6\">\r\n          {filteredImages.map(img => {\r\n            const displayCategory = getDisplayCategory(img);\r\n            return (\r\n              <div\r\n                key={img.id}\r\n                className=\"relative rounded-2xl overflow-hidden bg-white shadow-sm hover:shadow-md transition group cursor-pointer\"\r\n                onClick={() => setSelectedImage(img)}\r\n              >\r\n                <div className=\"relative\">\r\n                  {img.type === \"video\" ? (\r\n                    <div className=\"w-full h-64 bg-gray-900 flex items-center justify-center text-white text-3xl\">‚ñ∂</div>\r\n                  ) : (\r\n                    <img\r\n                      src={img.url}\r\n                      alt=\"Imagen del hotel\"\r\n                      className=\"w-full h-64 object-cover\"\r\n                      onError={(e) => {\r\n                        e.currentTarget.src = \"https://via.placeholder.com/400x300?text=Imagen+no+disponible\";\r\n                      }}\r\n                    />\r\n                  )}\r\n                  {/* ‚úÖ BOT√ìN DE ELIMINAR RESTAURADO - EN LA ESQUINA SUPERIOR DERECHA */}\r\n                  <button\r\n                    onClick={e => {\r\n                      e.stopPropagation();\r\n                      requestDelete(img.id, img.url);\r\n                    }}\r\n                    className=\"absolute top-3 right-3 z-10 w-8 h-8 rounded-full bg-black/20 flex items-center justify-center text-white opacity-0 group-hover:opacity-100 transition-all duration-300 hover:bg-red-500 hover:bg-opacity-90 hover:scale-105\"\r\n                    title=\"Eliminar imagen\"\r\n                  >\r\n                    <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" viewBox=\"0 0 24 24\">\r\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\r\n                    </svg>\r\n                  </button>\r\n                </div>\r\n                <div \r\n                  className=\"absolute bottom-0 left-0 w-full bg-gradient-to-t from-white/95 to-white/80 p-4\"\r\n                  style={{\r\n                    transition: 'all 1200ms cubic-bezier(0.34, 1.56, 0.64, 1)',\r\n                    height: hoveredCard === img.id ? '160px' : '56px',\r\n                    overflow: 'hidden',\r\n                  }}\r\n                  onMouseEnter={() => setHoveredCard(img.id)}\r\n                  onMouseLeave={() => setHoveredCard(null)}\r\n                >\r\n                  <h3 className=\"text-sm font-semibold text-gray-900 leading-snug\">\r\n                    {img.ai_title?.trim() ? img.ai_title : \"Imagen del hotel\"}\r\n                  </h3>\r\n                  {hoveredCard === img.id && (\r\n                    <div \r\n                      className=\"mt-3 text-xs text-gray-700 space-y-1.5\"\r\n                      style={{\r\n                        transition: 'opacity 800ms ease-out, transform 800ms ease-out',\r\n                        transform: hoveredCard === img.id ? 'translateY(0)' : 'translateY(10px)',\r\n                        opacity: hoveredCard === img.id ? 1 : 0,\r\n                      }}\r\n                    >\r\n                      <div className=\"flex items-center gap-1.5\">\r\n                        <span className=\"font-medium text-blue-600\">üè∑Ô∏è</span>\r\n                        <span>{CATEGORY_LABELS[displayCategory] || \"N/A\"}</span>\r\n                      </div>\r\n                      {img.tagsNormalized && img.tagsNormalized.length > 0 && (\r\n                        <div className=\"flex flex-wrap gap-1.5\">\r\n                          {img.tagsNormalized.slice(0, 3).map((tag: TagObj, i: number) => (\r\n                            <span key={i} className=\"px-2 py-0.5 bg-blue-50 text-blue-700 rounded-full text-[11px] font-medium\">\r\n                              {tag.label}\r\n                            </span>\r\n                          ))}\r\n                        </div>\r\n                      )}\r\n                      <div className=\"flex items-center gap-1.5\">\r\n                        <span className=\"font-medium text-blue-600\">üìÖ</span>\r\n                        <span>{img.created_at ? new Date(img.created_at).toLocaleDateString() : \"Fecha no disponible\"}</span>\r\n                      </div>\r\n                      {img.quality_score !== null && (\r\n                        <div className=\"flex items-center gap-1.5\">\r\n                          <span className=\"font-medium text-blue-600\">‚≠ê</span>\r\n                          <span>{qualityLabel(img.quality_score)}</span>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n      )}\r\n\r\n      {/* MODAL DE ELIMINACI√ìN */}\r\n      {showDeleteModal && (\r\n        <div className=\"fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center z-50\">\r\n          <div className=\"bg-white rounded-2xl p-6 max-w-sm w-full mx-4 shadow-2xl border border-gray-200\">\r\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">Eliminar imagen</h3>\r\n            <p className=\"text-sm text-gray-600 mb-4\">\r\n              ¬øEst√°s seguro de que quieres eliminar esta imagen?\r\n              <br />\r\n              <span className=\"text-red-600 font-semibold\">Esta acci√≥n no se puede deshacer.</span>\r\n            </p>\r\n            <div className=\"flex gap-3\">\r\n              <button\r\n                onClick={() => {\r\n                  setShowDeleteModal(false);\r\n                  setImageToDelete(null);\r\n                }}\r\n                className=\"flex-1 px-4 py-2.5 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50\"\r\n              >\r\n                Cancelar\r\n              </button>\r\n              <button\r\n                onClick={confirmDelete}\r\n                className=\"flex-1 px-4 py-2.5 bg-red-600 text-white rounded-lg text-sm font-medium hover:bg-red-700 shadow-sm hover:shadow-md\"\r\n              >\r\n                Eliminar\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* MODAL DE DESCARGAS */}\r\n      {selectedImage && (\r\n        <div className=\"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4\">\r\n          <div className=\"bg-white rounded-2xl max-w-6xl w-full max-h-[90vh] overflow-auto\">\r\n            <div className=\"p-6\">\r\n              <div className=\"flex justify-between items-start mb-4\">\r\n                <h3 className=\"text-xl font-bold text-gray-900\">Detalles de la imagen</h3>\r\n                <button onClick={() => setSelectedImage(null)} className=\"text-gray-500 hover:text-gray-700\">\r\n                  <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M6 18L18 6M6 6l12 12\" />\r\n                  </svg>\r\n                </button>\r\n              </div>\r\n              <div className=\"flex flex-col md:flex-row gap-6\">\r\n                <div className=\"md:w-1/2\">\r\n                  <div className=\"aspect-w-16 aspect-h-9 mb-4\">\r\n                    <img src={selectedImage.url} alt=\"Selected\" className=\"w-full h-full object-contain rounded-lg\" />\r\n                  </div>\r\n                </div>\r\n                <div className=\"md:w-1/2\">{renderDownloadTable(selectedImage.versions)}</div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1227, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/achra/proyectos/app-hotel-nueva/src/app/hotel-media/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { supabase } from \"../../lib/supabaseClient\";\r\nimport Gallery from \"@/components/Gallery\"; \r\n\r\ninterface Organization {\r\n  id: string;\r\n  name: string;\r\n  role: string;\r\n  address: string;\r\n  phone: string;\r\n  country: string;\r\n  province: string;\r\n  city: string;\r\n  website: string | null;\r\n  stars: number | null;\r\n  hotel_type: string | null;\r\n  profile_image: string | null;\r\n}\r\n\r\ninterface Notification {\r\n  id: string;\r\n  title: string;\r\n  message: string;\r\n  date: string;\r\n  read?: boolean;\r\n}\r\n\r\ninterface NotificationsDropdownProps {\r\n  notifications: Notification[];\r\n  unreadCount: number;\r\n  loading: boolean;\r\n  markAsRead: (id: string) => void;\r\n  markAllAsRead: () => void;\r\n  deleteNotification: (id: string) => void;\r\n}\r\n\r\nconst NotificationsDropdown = ({ \r\n  notifications, \r\n  unreadCount, \r\n  loading, \r\n  markAsRead, \r\n  markAllAsRead, \r\n  deleteNotification \r\n}: NotificationsDropdownProps) => {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      const target = event.target as HTMLElement;\r\n      if (!target.closest('.notifications-dropdown')) {\r\n        setIsOpen(false);\r\n      }\r\n    };\r\n\r\n    document.addEventListener('mousedown', handleClickOutside);\r\n    return () => document.removeEventListener('mousedown', handleClickOutside);\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"notifications-dropdown relative\">\r\n      <button\r\n        onClick={() => setIsOpen(!isOpen)}\r\n        className=\"relative p-2 text-gray-600 hover:text-blue-600 transition-all hover:-translate-y-0.5\"\r\n      >\r\n        <svg\r\n          className=\"w-6 h-6\"\r\n          fill=\"none\"\r\n          stroke=\"currentColor\"\r\n          strokeWidth=\"1.8\"\r\n          viewBox=\"0 0 24 24\"\r\n        >\r\n          <path\r\n            strokeLinecap=\"round\"\r\n            strokeLinejoin=\"round\"\r\n            d=\"M14.857 17.657A2 2 0 0113 19H11a2 2 0 01-1.857-1.343M6 8a6 6 0 1112 0c0 3.5 1.5 5 2 5.5H4c.5-.5 2-2 2-5.5z\"\r\n          />\r\n        </svg>\r\n\r\n        {unreadCount > 0 && (\r\n          <span className=\"absolute -top-1 -right-1 bg-red-600 text-white text-[10px] font-semibold w-5 h-5 rounded-full flex items-center justify-center shadow\">\r\n            {unreadCount}\r\n          </span>\r\n        )}\r\n      </button>\r\n\r\n      {isOpen && (\r\n        <div className=\"absolute right-0 mt-3 w-96 bg-white rounded-xl shadow-xl border border-gray-200 overflow-hidden z-50 animate-fade-in-down\">\r\n          <div className=\"flex items-center justify-between px-4 py-3 border-b border-gray-200 bg-gray-50\">\r\n            <h3 className=\"font-semibold text-gray-900\">Notificaciones</h3>\r\n\r\n            {unreadCount > 0 && (\r\n              <button\r\n                onClick={markAllAsRead}\r\n                className=\"text-xs font-medium text-blue-600 hover:text-blue-700 hover:underline\"\r\n              >\r\n                Marcar todo como le√≠do\r\n              </button>\r\n            )}\r\n          </div>\r\n\r\n          {loading && (\r\n            <div className=\"p-6 text-center text-gray-500 text-sm\">\r\n              <div className=\"w-6 h-6 mx-auto mb-2 border-2 border-blue-500 border-t-transparent rounded-full animate-spin\"></div>\r\n              Cargando notificaciones...\r\n            </div>\r\n          )}\r\n\r\n          {!loading && notifications.length === 0 && (\r\n            <div className=\"p-6 text-center text-gray-500 text-sm\">\r\n              <div className=\"text-5xl mb-3 opacity-30\">üîî</div>\r\n              No hay notificaciones\r\n            </div>\r\n          )}\r\n\r\n          {!loading && notifications.length > 0 && (\r\n            <div className=\"max-h-96 overflow-y-auto divide-y divide-gray-100\">\r\n              {notifications.map((n) => (\r\n                <div\r\n                  key={n.id}\r\n                  className={`flex items-start gap-3 px-4 py-4 transition-all cursor-pointer ${\r\n                    !n.read ? \"bg-blue-50\" : \"hover:bg-gray-50\"\r\n                  }`}\r\n                  onClick={() => !n.read && markAsRead(n.id)}\r\n                >\r\n                  <div className=\"pt-1\">\r\n                    {!n.read && (\r\n                      <span className=\"block w-2 h-2 bg-blue-600 rounded-full animate-pulse\"></span>\r\n                    )}\r\n                  </div>\r\n\r\n                  <div className=\"flex-1\">\r\n                    <p className=\"text-sm font-semibold text-gray-900\">\r\n                      {n.title}\r\n                    </p>\r\n                    <p className=\"text-xs text-gray-600 mt-1\">{n.message}</p>\r\n                    <p className=\"text-[11px] text-gray-400 mt-1\">{n.date}</p>\r\n                  </div>\r\n\r\n                  <div className=\"flex items-start\">\r\n                    <button\r\n                      onClick={(e) => {\r\n                        e.stopPropagation();\r\n                        deleteNotification(n.id);\r\n                      }}\r\n                      className=\"text-gray-400 hover:text-red-600 hover:scale-110 transition-transform\"\r\n                      title=\"Eliminar\"\r\n                    >\r\n                      <svg\r\n                        className=\"w-4 h-4\"\r\n                        fill=\"none\"\r\n                        stroke=\"currentColor\"\r\n                        strokeWidth=\"2\"\r\n                        viewBox=\"0 0 24 24\"\r\n                      >\r\n                        <path\r\n                          strokeLinecap=\"round\"\r\n                          strokeLinejoin=\"round\"\r\n                          d=\"M6 18L18 6M6 6l12 12\"\r\n                        />\r\n                      </svg>\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nconst DeletePhotoModal = ({\r\n  isOpen,\r\n  onClose,\r\n  onConfirm,\r\n  photoName,\r\n}: {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onConfirm: () => void;\r\n  photoName?: string;\r\n}) => {\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50\">\r\n      <div className=\"bg-white rounded-2xl p-6 max-w-md w-full mx-4 shadow-2xl border border-gray-200\">\r\n        <h3 className=\"text-lg font-bold text-gray-900 mb-2\">Confirmar eliminaci√≥n</h3>\r\n        <p className=\"text-gray-600 text-sm leading-relaxed mb-4\">\r\n          {photoName\r\n            ? `¬øEst√°s seguro de que quieres eliminar \"${photoName}\"?`\r\n            : \"¬øEst√°s seguro de que quieres eliminar esta foto?\"}\r\n          <br />\r\n          <span className=\"text-red-600 font-semibold\">Esta acci√≥n no se puede deshacer.</span>\r\n        </p>\r\n\r\n        <div className=\"flex gap-3\">\r\n          <button\r\n            onClick={onClose}\r\n            className=\"flex-1 px-4 py-2.5 border border-gray-300 rounded-lg font-medium text-gray-700 hover:bg-gray-50\"\r\n          >\r\n            Cancelar\r\n          </button>\r\n\r\n          <button\r\n            onClick={onConfirm}\r\n            className=\"flex-1 px-4 py-2.5 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 shadow-sm hover:shadow-md\"\r\n          >\r\n            Eliminar permanentemente\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\ninterface MediaItem {\r\n  id: string;\r\n  url: string;\r\n  type: \"image\" | \"video\";\r\n  tags?: any;\r\n  category?: string;\r\n  quality_score?: number;\r\n  created_at: string;\r\n  versions?: any;\r\n  ai_title?: string;\r\n}\r\n\r\nexport default function HotelMediaPage() {\r\n  const [org, setOrg] = useState<Organization | null>(null);\r\n  const [media, setMedia] = useState<MediaItem[]>([]);\r\n  const [approvedHotels, setApprovedHotels] = useState<{ id: string; name: string }[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [activeSection, setActiveSection] = useState(\"gallery\");\r\n  const [totalMedia, setTotalMedia] = useState(0);\r\n  const [pendingRequests, setPendingRequests] = useState(0);\r\n  const [connectedAgencies, setConnectedAgencies] = useState(0);\r\n  const [totalHotels, setTotalHotels] = useState(0);\r\n  const [userId, setUserId] = useState<string | null>(null);\r\n  const [hotelId, setHotelId] = useState<string | null>(null);\r\n\r\n  const [showDeleteModal, setShowDeleteModal] = useState(false);\r\n  const [photoToDelete, setPhotoToDelete] = useState<{ id: string; name?: string } | null>(null);\r\n  const [selectedImage, setSelectedImage] = useState<MediaItem | null>(null);\r\n\r\n  const [notifications, setNotifications] = useState<Notification[]>([]);\r\n  const unreadCount = notifications.filter(n => !n.read).length;\r\n  const notificationsLoading = false;\r\n\r\n  const markAsRead = (id: string) => {\r\n    setNotifications(prev => \r\n      prev.map(n => n.id === id ? { ...n, read: true } : n)\r\n    );\r\n  };\r\n\r\n  const markAllAsRead = () => {\r\n    setNotifications(prev => \r\n      prev.map(n => ({ ...n, read: true }))\r\n    );\r\n  };\r\n\r\n  const deleteNotification = (id: string) => {\r\n    setNotifications(prev => \r\n      prev.filter(n => n.id !== id)\r\n    );\r\n  };\r\n\r\n  const normalizeHotelGalleryTags = (raw: any): string[] => {\r\n    if (!raw) return [];\r\n    if (typeof raw === 'string') {\r\n      try {\r\n        return normalizeHotelGalleryTags(JSON.parse(raw));\r\n      } catch {\r\n        return [];\r\n      }\r\n    }\r\n    if (Array.isArray(raw)) {\r\n      return raw\r\n        .map(t => {\r\n          if (typeof t === 'string') {\r\n            try {\r\n              const parsed = JSON.parse(t);\r\n              return parsed?.label ?? t;\r\n            } catch {\r\n              return t;\r\n            }\r\n          }\r\n          if (typeof t === 'object') {\r\n            return t.label ?? t.tag ?? null;\r\n          }\r\n          return null;\r\n        })\r\n        .filter(Boolean)\r\n        .map(t => String(t).toLowerCase());\r\n    }\r\n    return [];\r\n  };\r\n\r\n  const handleDownload = async (url: string, filename: string) => {\r\n    try {\r\n      const response = await fetch(url);\r\n      const blob = await response.blob();\r\n      const blobUrl = URL.createObjectURL(blob);\r\n      const a = document.createElement('a');\r\n      a.href = blobUrl;\r\n      a.download = filename;\r\n      document.body.appendChild(a);\r\n      a.click();\r\n      document.body.removeChild(a);\r\n      URL.revokeObjectURL(blobUrl);\r\n    } catch (error) {\r\n      console.error('Error al descargar la imagen:', error);\r\n      alert('Error al descargar la imagen. Int√©ntalo de nuevo.');\r\n    }\r\n  };\r\n\r\n  const renderDownloadTable = (versions: any) => {\r\n    if (!versions) return null;\r\n    \r\n    const originalDimensions = versions.original?.dimensions;\r\n    let originalWidth = 0;\r\n    let originalHeight = 0;\r\n\r\n    if (originalDimensions) {\r\n      const [w, h] = originalDimensions.split('x').map(Number);\r\n      originalWidth = w;\r\n      originalHeight = h;\r\n    }\r\n\r\n    const validVersions = Object.entries(versions)\r\n      .filter(([size, details]: [string, any]) => {\r\n        if (size === 'original') return true;\r\n        if (!details?.dimensions) return false;\r\n        const [w, h] = details.dimensions.split('x').map(Number);\r\n        return w <= originalWidth && h <= originalHeight;\r\n      })\r\n      .sort((a, b) => {\r\n        const order = ['thumbnail', 'small', 'medium', 'large', 'original'];\r\n        return order.indexOf(a[0]) - order.indexOf(b[0]);\r\n      });\r\n\r\n    return (\r\n      <div>\r\n        <h4 className=\"text-sm font-medium text-gray-700 mb-3\">Opciones de descarga</h4>\r\n        <div className=\"bg-white rounded-xl shadow-sm overflow-hidden border border-gray-200\">\r\n          <div className=\"overflow-x-auto\">\r\n            <table className=\"min-w-full divide-y divide-gray-200 table-fixed\">\r\n              <thead className=\"bg-gray-50\">\r\n                <tr>\r\n                  <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-1/4\">\r\n                    Descripci√≥n\r\n                  </th>\r\n                  <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-1/4\">\r\n                    Dimensiones\r\n                  </th>\r\n                  <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-1/4\">\r\n                    Relaci√≥n\r\n                  </th>\r\n                  <th className=\"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider w-1/4\">\r\n                    Acciones\r\n                  </th>\r\n                </tr>\r\n              </thead>\r\n              <tbody className=\"bg-white divide-y divide-gray-200\">\r\n                {validVersions.map(([size, details]: [string, any]) => (\r\n                  <tr key={size} className=\"hover:bg-gray-50\">\r\n                    <td className=\"px-4 py-4 whitespace-nowrap text-sm font-medium text-gray-900 truncate\">\r\n                      {size === 'thumbnail' ? 'Miniatura' : \r\n                       size === 'small' ? 'Peque√±o' : \r\n                       size === 'medium' ? 'Mediano' : \r\n                       size === 'large' ? 'Grande' : 'Original'}\r\n                    </td>\r\n                    <td className=\"px-4 py-4 whitespace-nowrap text-sm text-gray-500 truncate\">\r\n                      {details.dimensions}\r\n                    </td>\r\n                    <td className=\"px-4 py-4 whitespace-nowrap text-sm text-gray-500 truncate\">\r\n                      {details.aspect_ratio}\r\n                    </td>\r\n                    <td className=\"px-4 py-4 whitespace-nowrap text-right text-sm font-medium\">\r\n                      <div className=\"flex justify-end gap-2\">\r\n                        <button\r\n                          onClick={() =>\r\n                            handleDownload(details.url, `${size}-${Date.now()}.jpg`)\r\n                          }\r\n                          className=\"inline-flex items-center justify-center w-9 h-9 rounded-lg text-blue-600 bg-blue-50 hover:bg-blue-100 transition-colors shadow-sm hover:shadow-md\"\r\n                          title=\"Descargar\"\r\n                        >\r\n                          <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\" />\r\n                          </svg>\r\n                        </button>\r\n                        \r\n                        <a\r\n                          href={details.url}\r\n                          target=\"_blank\"\r\n                          rel=\"noopener noreferrer\"\r\n                          className=\"inline-flex items-center justify-center w-9 h-9 rounded-lg text-gray-500 hover:text-gray-700 hover:bg-gray-100 transition-colors shadow-sm hover:shadow\"\r\n                          title=\"Ver imagen\"\r\n                        >\r\n                          <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\r\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\r\n                          </svg>\r\n                        </a>\r\n                      </div>\r\n                    </td>\r\n                  </tr>\r\n                ))}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const refreshGallery = async () => {\r\n    if (!org || org.role !== \"hotel\") return;\r\n    \r\n    const { data: mediaData } = await supabase\r\n      .from(\"media\")\r\n      .select(\"id, url, type, versions, tags, quality_score, ai_title, category, created_at\")\r\n      .eq(\"hotel_id\", org.id)\r\n      .order(\"created_at\", { ascending: false });\r\n\r\n    const parsedMedia = mediaData?.map(item => {\r\n      let versions = item.versions;\r\n      if (versions && typeof versions === 'string') {\r\n        try {\r\n          versions = JSON.parse(versions);\r\n        } catch {\r\n          // keep as-is\r\n        }\r\n      }\r\n      return {\r\n        ...item,\r\n        versions\r\n      };\r\n    }) || [];\r\n\r\n    setMedia(parsedMedia as MediaItem[]);\r\n    setTotalMedia(mediaData?.length || 0);\r\n  };\r\n\r\n  useEffect(() => {\r\n    const loadOrg = async () => {\r\n      try {\r\n        const { data, error: userError } = await supabase.auth.getUser();\r\n        \r\n        if (userError || !data?.user) {\r\n          console.error('Error getting user:', userError);\r\n          window.location.href = \"/login\";\r\n          return;\r\n        }\r\n\r\n        const userId = data.user.id;\r\n        setUserId(userId);\r\n\r\n        const { data: orgData } = await supabase\r\n          .from(\"organizations\")\r\n          .select(\"*\")\r\n          .eq(\"created_by\", userId)\r\n          .maybeSingle();\r\n\r\n        if (!orgData) {\r\n          window.location.href = \"/setup-organization\";\r\n          return;\r\n        }\r\n\r\n        setOrg(orgData as Organization);\r\n\r\n        if (orgData.role === \"hotel\") {\r\n          setHotelId(orgData.id);\r\n          \r\n          const { data: mediaData } = await supabase\r\n            .from(\"media\")\r\n            .select(\"id, url, type, versions, tags, quality_score, ai_title, category, created_at\")\r\n            .eq(\"hotel_id\", orgData.id)\r\n            .order(\"created_at\", { ascending: false });\r\n\r\n          const parsedMedia = mediaData?.map(item => {\r\n            let versions = item.versions;\r\n            if (versions && typeof versions === 'string') {\r\n              try {\r\n                versions = JSON.parse(versions);\r\n              } catch {\r\n                // keep as-is\r\n              }\r\n            }\r\n            return {\r\n              ...item,\r\n              versions\r\n            };\r\n          }) || [];\r\n\r\n          setMedia(parsedMedia as MediaItem[]);\r\n          setTotalMedia(mediaData?.length || 0);\r\n\r\n          const { data: requestsData } = await supabase\r\n            .from(\"agency_hotel_access\")\r\n            .select(\"id\")\r\n            .eq(\"hotel_id\", orgData.id)\r\n            .eq(\"status\", \"pending\");\r\n\r\n          setPendingRequests(requestsData?.length || 0);\r\n\r\n          const { data: connectedData } = await supabase\r\n            .from(\"agency_hotel_access\")\r\n            .select(\"id\")\r\n            .eq(\"hotel_id\", orgData.id)\r\n            .eq(\"status\", \"approved\");\r\n\r\n          setConnectedAgencies(connectedData?.length || 0);\r\n        }\r\n\r\n        if (orgData.role === \"agency\") {\r\n          const { data: accessData } = await supabase\r\n            .from(\"agency_hotel_access\")\r\n            .select(\"hotel_id, status\")\r\n            .eq(\"agency_id\", orgData.id);\r\n\r\n          if (accessData && Array.isArray(accessData)) {\r\n            const approved = accessData.filter((a) => a.status === \"approved\");\r\n            const pending = accessData.filter((a) => a.status === \"pending\");\r\n\r\n            setTotalHotels(approved.length);\r\n            setPendingRequests(pending.length);\r\n\r\n            const hotelIds = approved.map((a) => a.hotel_id);\r\n\r\n            const { data: hotelsData } = await supabase\r\n              .from(\"organizations\")\r\n              .select(\"id, name\")\r\n              .in(\"id\", hotelIds);\r\n\r\n            setApprovedHotels(hotelsData || []);\r\n          }\r\n        }\r\n\r\n        setLoading(false);\r\n      } catch (err) {\r\n        console.error(\"Error loading data:\", err);\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    loadOrg();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!org || org.role !== \"hotel\") return;\r\n\r\n    const channel = supabase\r\n      .channel('media-updates')\r\n      .on('postgres_changes', {\r\n        event: 'INSERT',\r\n        schema: 'public',\r\n        table: 'media',\r\n        filter: `hotel_id=eq.${org.id}`\r\n      }, async () => {\r\n        await refreshGallery();\r\n      })\r\n      .on('postgres_changes', {\r\n        event: 'DELETE',\r\n        schema: 'public',\r\n        table: 'media',\r\n        filter: `hotel_id=eq.${org.id}`\r\n      }, async () => {\r\n        await refreshGallery();\r\n      })\r\n      .subscribe();\r\n\r\n    return () => {\r\n      supabase.removeChannel(channel);\r\n    };\r\n  }, [org]);\r\n\r\n  const handleLogout = async () => {\r\n    await supabase.auth.signOut();\r\n    window.location.href = \"/\";\r\n  };\r\n\r\n  const handleDeletePhoto = async () => {\r\n    if (!photoToDelete) return;\r\n\r\n    try {\r\n      const photo = media.find((m) => m.id === photoToDelete.id);\r\n      if (!photo) throw new Error(\"Foto no encontrada\");\r\n\r\n      const fileName = photo.url.split(\"/\").pop();\r\n      await supabase.storage.from(\"media\").remove([fileName!]);\r\n      await supabase.from(\"media\").delete().eq(\"id\", photoToDelete.id);\r\n\r\n      setShowDeleteModal(false);\r\n      setPhotoToDelete(null);\r\n      await refreshGallery();\r\n    } catch (err) {\r\n      console.error(\"Error al eliminar foto:\", err);\r\n      alert(\"Error al eliminar la foto. Int√©ntalo de nuevo.\");\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen flex justify-center items-center bg-white\">\r\n        <div className=\"p-8 bg-white rounded-xl shadow-sm text-center\">\r\n          <div className=\"w-8 h-8 mx-auto mb-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin\"></div>\r\n          <p className=\"text-gray-600 text-base\">Cargando...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!org) return null;\r\n\r\n  return (\r\n    <div className=\"min-h-screen flex bg-gray-50 font-sans\">\r\n      <aside className=\"w-72 bg-gradient-to-b from-blue-800 to-blue-900 text-white p-6 fixed left-0 top-0 h-screen flex flex-col\">\r\n        <div className=\"flex items-center mb-8 pb-3 border-b border-white/10\">\r\n          <h1 className=\"text-xl font-bold tracking-tight\">Hotel Media Bank</h1>\r\n        </div>\r\n\r\n        <nav className=\"flex-1 flex flex-col gap-2\">\r\n          <div\r\n            onClick={() => (window.location.href = \"/dashboard\")}\r\n            className=\"px-4 py-3.5 rounded-lg cursor-pointer font-medium text-sm transition-all text-white/80 hover:bg-white/10 flex items-center gap-2\"\r\n          >\r\n            <span className=\"text-lg\">‚Üê</span>\r\n            <span>Volver al Dashboard</span>\r\n          </div>\r\n        </nav>\r\n\r\n        <div className=\"mt-auto pt-5 border-t border-white/10\">\r\n          <button\r\n            onClick={handleLogout}\r\n            className=\"w-full flex items-center justify-center gap-2 py-0.5 text-blue-200/90 hover:text-white transition-colors text-sm font-medium\"\r\n          >\r\n            <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2}\r\n                d=\"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1\" />\r\n            </svg>\r\n            Cerrar Sesi√≥n\r\n          </button>\r\n        </div>\r\n      </aside>\r\n\r\n      <main className=\"flex-1 ml-72 bg-gray-50 p-8 overflow-y-auto\">\r\n        <div className=\"fixed top-0 left-72 right-0 h-16 bg-white shadow-sm flex items-center justify-between px-8 z-40\">\r\n          <span className=\"text-sm text-gray-500 uppercase font-semibold\">\r\n            {activeSection === \"gallery\" ? \"Dashboard\" : activeSection}\r\n          </span>\r\n\r\n          <NotificationsDropdown\r\n            notifications={notifications}\r\n            unreadCount={unreadCount}\r\n            loading={notificationsLoading}\r\n            markAsRead={markAsRead}\r\n            markAllAsRead={markAllAsRead}\r\n            deleteNotification={deleteNotification}\r\n          />\r\n        </div>\r\n\r\n        <div className=\"pt-24\">\r\n          <div className=\"mb-8\">\r\n            <h2 className=\"text-3xl font-bold text-gray-900 mb-2\">\r\n              {org.role === \"hotel\" ? \"Mi Galer√≠a\" : \"Hoteles Disponibles\"}\r\n            </h2>\r\n            <p className=\"text-gray-600 text-base\">\r\n              {org.role === \"hotel\"\r\n                ? \"Gestiona y comparte tu contenido multimedia con agencias autorizadas\"\r\n                : \"Accede al contenido multimedia de tus hoteles asociados\"}\r\n            </p>\r\n          </div>\r\n\r\n          {org.role === \"hotel\" && (\r\n            <div className=\"max-w-7xl mx-auto bg-white rounded-2xl shadow-lg overflow-hidden\">\r\n              <div className=\"p-8\">\r\n                <Gallery \r\n                  media={media} \r\n                  hotelId={hotelId}\r\n                  onMediaChange={refreshGallery}\r\n                  onImageSelect={setSelectedImage}\r\n                />\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {org.role === \"agency\" && (\r\n            <div className=\"max-w-7xl mx-auto bg-white rounded-2xl shadow-lg overflow-hidden\">\r\n              <div className=\"p-8\">\r\n                <div className=\"text-center py-12 text-gray-500\">\r\n                  Funcionalidad de agencias en desarrollo\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        <DeletePhotoModal\r\n          isOpen={showDeleteModal}\r\n          onClose={() => {\r\n            setShowDeleteModal(false);\r\n            setPhotoToDelete(null);\r\n          }}\r\n          onConfirm={handleDeletePhoto}\r\n          photoName={photoToDelete?.name}\r\n        />\r\n\r\n        {/* ‚úÖ PANEL DE DESCARGA OPTIMIZADO - IMAGEN PERFECTAMENTE CENTRADA CON LA TABLA */}\r\n        {selectedImage && (\r\n          <div\r\n            className=\"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4\"\r\n            onClick={() => setSelectedImage(null)}\r\n          >\r\n            <div className=\"bg-white rounded-2xl w-full max-w-6xl max-h-[95vh] flex flex-col overflow-hidden shadow-2xl\">\r\n              {/* Encabezado que abarca TODO el ancho */}\r\n              <div className=\"p-6 md:p-8 border-b border-gray-200\">\r\n                <div className=\"flex justify-between items-start\">\r\n                  <div>\r\n                    <h3 className=\"text-2xl font-bold text-gray-900 mb-1\">\r\n                      {selectedImage.ai_title?.trim() || \"Imagen del hotel\"}\r\n                    </h3>\r\n                    <p className=\"text-sm text-gray-500\">\r\n                      {selectedImage.category?.replace(\"_\", \" \") || \"Sin categor√≠a\"}\r\n                    </p>\r\n                  </div>\r\n                  <button \r\n                    onClick={(e) => {\r\n                      e.stopPropagation();\r\n                      setSelectedImage(null);\r\n                    }}\r\n                    className=\"text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-full w-8 h-8 flex items-center justify-center transition-colors\"\r\n                    aria-label=\"Cerrar panel\"\r\n                  >\r\n                    <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n                    </svg>\r\n                  </button>\r\n                </div>\r\n              </div>\r\n              \r\n              {/* Contenido dividido en dos columnas - MISMO PADDING EN AMBAS */}\r\n              <div className=\"flex flex-col md:flex-row overflow-hidden\">\r\n                {/* Contenedor de imagen - SIN max-h en el contenedor, SOLO en la imagen */}\r\n                <div className=\"md:w-1/2 flex items-center justify-center bg-gray-50 p-6 md:p-8\">\r\n                  <div className=\"w-full max-w-[90%] flex items-center justify-center\">\r\n                    <img \r\n                      src={selectedImage.url} \r\n                      alt={selectedImage.ai_title || \"Imagen del hotel\"}\r\n                      className=\"max-w-full max-h-[75vh] object-contain rounded-lg shadow-lg\"\r\n                      loading=\"lazy\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n                \r\n                {/* Panel de descargas - SIN mt-6, mismo padding que la imagen */}\r\n                <div className=\"md:w-1/2 p-6 md:p-8 overflow-y-auto\">\r\n                  {renderDownloadTable(selectedImage.versions)}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </main>\r\n\r\n      <style jsx global>{`\r\n        @keyframes fade-in-down {\r\n          from {\r\n            opacity: 0;\r\n            transform: translateY(-10px);\r\n          }\r\n          to {\r\n            opacity: 1;\r\n            transform: translateY(0);\r\n          }\r\n        }\r\n        .animate-fade-in-down {\r\n          animation: fade-in-down 0.2s ease-out;\r\n        }\r\n      `}</style>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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"}}]
}