{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 100, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/achra/proyectos/app-hotel-nueva/src/lib/ai.ts"],"sourcesContent":["// lib/ai.ts\r\nexport async function analyzeImage(url: string, threshold: number = 0.05) {\r\n  try {\r\n    const response = await fetch('http://localhost:8000/analyze', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify({ url, threshold }),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error(`Error en an√°lisis: ${response.status}`);\r\n    }\r\n\r\n    const data = await response.json();\r\n    return data;\r\n  } catch (error) {\r\n    console.error('‚ùå Error al analizar imagen:', error);\r\n    throw error;\r\n  }\r\n}\r\n"],"names":[],"mappings":"AAAA,YAAY;;;;;AACL,eAAe,aAAa,GAAW,EAAE,YAAoB,IAAI;IACtE,IAAI;QACF,MAAM,WAAW,MAAM,MAAM,iCAAiC;YAC5D,QAAQ;YACR,SAAS;gBACP,gBAAgB;YAClB;YACA,MAAM,KAAK,SAAS,CAAC;gBAAE;gBAAK;YAAU;QACxC;QAEA,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,MAAM,IAAI,MAAM,CAAC,mBAAmB,EAAE,SAAS,MAAM,EAAE;QACzD;QAEA,MAAM,OAAO,MAAM,SAAS,IAAI;QAChC,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,+BAA+B;QAC7C,MAAM;IACR;AACF"}},
    {"offset": {"line": 131, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/achra/proyectos/app-hotel-nueva/src/utils/categoryMap.ts"],"sourcesContent":["// utils/categoryMap.ts\r\n\r\nexport type RawTag = string | { label: string; score?: number };\r\n\r\nexport const CATEGORY_MAP: Record<string, string[]> = {\r\n  exterior: [\r\n    'exterior',\r\n    'garden',\r\n    'parking',\r\n    'view',\r\n    'balcony',\r\n    'terrace',\r\n    'facade'\r\n  ],\r\n  habitaciones: [\r\n    'hotel room',\r\n    'suite',\r\n    'family room',\r\n    'double room',\r\n    'single room',\r\n    'king bed',\r\n    'queen bed',\r\n    'bedroom'\r\n  ],\r\n  interior: [\r\n    'corridor',\r\n    'hallway',\r\n    'interior',\r\n    'bathroom'\r\n  ],\r\n  salas_comunes: [\r\n    'lobby',\r\n    'reception',\r\n    'hall',\r\n    'common area',\r\n    'breakfast area'\r\n  ],\r\n  restaurante: [\r\n    'restaurant',\r\n    'bar'\r\n  ],\r\n  piscina: [\r\n    'swimming pool',\r\n    'pool'\r\n  ],\r\n  spa: [\r\n    'spa',\r\n    'gym'\r\n  ]\r\n};\r\n\r\n/**\r\n * Normaliza tags a string[] en lowercase\r\n */\r\nfunction normalizeTags(tags: RawTag[]): string[] {\r\n  return tags\r\n    .flatMap(tag => {\r\n      if (typeof tag === 'string') {\r\n        const t = tag.trim();\r\n\r\n        if (t.startsWith('{') && t.endsWith('}')) {\r\n          try {\r\n            const parsed = JSON.parse(t);\r\n            if (parsed?.label) return parsed.label;\r\n          } catch {}\r\n        }\r\n\r\n        return t;\r\n      }\r\n\r\n      if (typeof tag === 'object' && typeof tag.label === 'string') {\r\n        return tag.label;\r\n      }\r\n\r\n      return [];\r\n    })\r\n    .filter(Boolean)\r\n    .map(t => t.toLowerCase());\r\n}\r\n\r\n/**\r\n * Detecta categor√≠a con prioridades reales de hotel\r\n * PRIORIDADES:\r\n * 1. piscina\r\n * 2. habitaciones\r\n * 3. spa\r\n * 4. restaurante\r\n * 5. salas comunes\r\n * 6. interior\r\n * 7. exterior\r\n */\r\nexport function detectCategory(tags: RawTag[]): string {\r\n  const normalized = normalizeTags(tags);\r\n\r\n  if (!normalized.length) return 'otros';\r\n\r\n  // 1. Prioridad m√°xima\r\n  if (normalized.includes('swimming pool') || normalized.includes('pool')) {\r\n    return 'piscina';\r\n  }\r\n\r\n  if (\r\n    normalized.includes('hotel room') ||\r\n    normalized.includes('suite') ||\r\n    normalized.includes('bedroom') ||\r\n    normalized.includes('double room') ||\r\n    normalized.includes('single room')\r\n  ) {\r\n    return 'habitaciones';\r\n  }\r\n\r\n  if (normalized.includes('spa') || normalized.includes('gym')) {\r\n    return 'spa';\r\n  }\r\n\r\n  if (normalized.includes('restaurant') || normalized.includes('bar')) {\r\n    return 'restaurante';\r\n  }\r\n\r\n  // 2. Prioridad media\r\n  if (\r\n    normalized.includes('lobby') ||\r\n    normalized.includes('reception') ||\r\n    normalized.includes('common area') ||\r\n    normalized.includes('breakfast area')\r\n  ) {\r\n    return 'salas_comunes';\r\n  }\r\n\r\n  if (\r\n    normalized.includes('bathroom') ||\r\n    normalized.includes('corridor') ||\r\n    normalized.includes('interior') ||\r\n    normalized.includes('hallway')\r\n  ) {\r\n    return 'interior';\r\n  }\r\n\r\n  // 3. Exterior (√∫ltima opci√≥n)\r\n  if (\r\n    normalized.includes('exterior') ||\r\n    normalized.includes('view') ||\r\n    normalized.includes('balcony') ||\r\n    normalized.includes('terrace') ||\r\n    normalized.includes('garden') ||\r\n    normalized.includes('facade')\r\n  ) {\r\n    return 'exterior';\r\n  }\r\n\r\n  return 'otros';\r\n}\r\n"],"names":[],"mappings":"AAAA,uBAAuB;;;;;;;AAIhB,MAAM,eAAyC;IACpD,UAAU;QACR;QACA;QACA;QACA;QACA;QACA;QACA;KACD;IACD,cAAc;QACZ;QACA;QACA;QACA;QACA;QACA;QACA;QACA;KACD;IACD,UAAU;QACR;QACA;QACA;QACA;KACD;IACD,eAAe;QACb;QACA;QACA;QACA;QACA;KACD;IACD,aAAa;QACX;QACA;KACD;IACD,SAAS;QACP;QACA;KACD;IACD,KAAK;QACH;QACA;KACD;AACH;AAEA;;CAEC,GACD,SAAS,cAAc,IAAc;IACnC,OAAO,KACJ,OAAO,CAAC,CAAA;QACP,IAAI,OAAO,QAAQ,UAAU;YAC3B,MAAM,IAAI,IAAI,IAAI;YAElB,IAAI,EAAE,UAAU,CAAC,QAAQ,EAAE,QAAQ,CAAC,MAAM;gBACxC,IAAI;oBACF,MAAM,SAAS,KAAK,KAAK,CAAC;oBAC1B,IAAI,QAAQ,OAAO,OAAO,OAAO,KAAK;gBACxC,EAAE,OAAM,CAAC;YACX;YAEA,OAAO;QACT;QAEA,IAAI,OAAO,QAAQ,YAAY,OAAO,IAAI,KAAK,KAAK,UAAU;YAC5D,OAAO,IAAI,KAAK;QAClB;QAEA,OAAO,EAAE;IACX,GACC,MAAM,CAAC,SACP,GAAG,CAAC,CAAA,IAAK,EAAE,WAAW;AAC3B;AAaO,SAAS,eAAe,IAAc;IAC3C,MAAM,aAAa,cAAc;IAEjC,IAAI,CAAC,WAAW,MAAM,EAAE,OAAO;IAE/B,sBAAsB;IACtB,IAAI,WAAW,QAAQ,CAAC,oBAAoB,WAAW,QAAQ,CAAC,SAAS;QACvE,OAAO;IACT;IAEA,IACE,WAAW,QAAQ,CAAC,iBACpB,WAAW,QAAQ,CAAC,YACpB,WAAW,QAAQ,CAAC,cACpB,WAAW,QAAQ,CAAC,kBACpB,WAAW,QAAQ,CAAC,gBACpB;QACA,OAAO;IACT;IAEA,IAAI,WAAW,QAAQ,CAAC,UAAU,WAAW,QAAQ,CAAC,QAAQ;QAC5D,OAAO;IACT;IAEA,IAAI,WAAW,QAAQ,CAAC,iBAAiB,WAAW,QAAQ,CAAC,QAAQ;QACnE,OAAO;IACT;IAEA,qBAAqB;IACrB,IACE,WAAW,QAAQ,CAAC,YACpB,WAAW,QAAQ,CAAC,gBACpB,WAAW,QAAQ,CAAC,kBACpB,WAAW,QAAQ,CAAC,mBACpB;QACA,OAAO;IACT;IAEA,IACE,WAAW,QAAQ,CAAC,eACpB,WAAW,QAAQ,CAAC,eACpB,WAAW,QAAQ,CAAC,eACpB,WAAW,QAAQ,CAAC,YACpB;QACA,OAAO;IACT;IAEA,8BAA8B;IAC9B,IACE,WAAW,QAAQ,CAAC,eACpB,WAAW,QAAQ,CAAC,WACpB,WAAW,QAAQ,CAAC,cACpB,WAAW,QAAQ,CAAC,cACpB,WAAW,QAAQ,CAAC,aACpB,WAAW,QAAQ,CAAC,WACpB;QACA,OAAO;IACT;IAEA,OAAO;AACT"}},
    {"offset": {"line": 237, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/achra/proyectos/app-hotel-nueva/src/lib/supabaseClient.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js'\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\r\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\r\n\r\n// ‚úÖ A√±ade esta verificaci√≥n\r\nconsole.log(\"Supabase URL:\", supabaseUrl);\r\nconsole.log(\"Supabase Key:\", supabaseAnonKey);\r\n\r\nif (!supabaseUrl || !supabaseAnonKey) {\r\n  throw new Error('Missing Supabase environment variables');\r\n}\r\n\r\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey);"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM;AACN,MAAM;AAEN,4BAA4B;AAC5B,QAAQ,GAAG,CAAC,iBAAiB;AAC7B,QAAQ,GAAG,CAAC,iBAAiB;AAE7B;;AAIO,MAAM,WAAW,IAAA,gMAAY,EAAC,aAAa"}},
    {"offset": {"line": 255, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/achra/proyectos/app-hotel-nueva/src/lib/aiTitleTemplates.ts"],"sourcesContent":["// src/lib/aiTitleTemplates.ts\r\n\r\nexport const TITLE_TEMPLATES = {\r\n  // ============================\r\n  // üü¶ PISCINA\r\n  // ============================\r\n  piscina: [\r\n    { es: \"Piscina exterior al atardecer\", en: \"Outdoor pool at sunset\" },\r\n    { es: \"Piscina con vistas al mar\", en: \"Pool with sea view\" },\r\n    { es: \"Piscina interior climatizada\", en: \"Indoor heated pool\" },\r\n    { es: \"Piscina rodeada de jardines\", en: \"Pool surrounded by gardens\" },\r\n    { es: \"Piscina con tumbonas modernas\", en: \"Pool with modern loungers\" },\r\n    { es: \"Piscina iluminada por la noche\", en: \"Pool illuminated at night\" },\r\n    { es: \"Piscina infinita con vistas\", en: \"Infinity pool with views\" },\r\n    { es: \"Piscina exterior con palmeras\", en: \"Outdoor pool with palm trees\" },\r\n    { es: \"Piscina junto a zona lounge\", en: \"Pool next to lounge area\" },\r\n    { es: \"Piscina con agua cristalina\", en: \"Pool with crystal clear water\" },\r\n\r\n    // ‚≠ê COMBINADOS PISCINA + EXTERIOR\r\n    { es: \"Piscina frente a la fachada del hotel\", en: \"Pool in front of the hotel facade\" },\r\n    { es: \"Piscina con vistas al mar y al hotel\", en: \"Pool with sea view and hotel building\" },\r\n    { es: \"Piscina junto a la fachada iluminada\", en: \"Pool next to illuminated hotel facade\" },\r\n    { es: \"Piscina exterior con palmeras y hotel\", en: \"Outdoor pool with palm trees and hotel\" },\r\n    { es: \"Piscina con vistas al mar y palmeras\", en: \"Pool with sea view and palm trees\" },\r\n    { es: \"Piscina frente al hotel con vistas al mar\", en: \"Pool in front of hotel with sea view\" },\r\n    { es: \"Piscina exterior con vistas al oc√©ano\", en: \"Outdoor pool with ocean view\" },\r\n    { es: \"Piscina junto a terraza con vistas\", en: \"Pool next to terrace with views\" },\r\n    { es: \"Piscina exterior con ambiente tropical\", en: \"Outdoor pool with tropical ambience\" },\r\n    { es: \"Piscina con vistas al mar y zona exterior\", en: \"Pool with sea view and outdoor area\" },\r\n  ],\r\n\r\n  // ============================\r\n  // üü© EXTERIOR\r\n  // ============================\r\n  exterior: [\r\n    { es: \"Fachada del hotel iluminada\", en: \"Illuminated hotel facade\" },\r\n    { es: \"Entrada exterior moderna\", en: \"Modern exterior entrance\" },\r\n    { es: \"Zona exterior ajardinada\", en: \"Garden outdoor area\" },\r\n    { es: \"Terraza con vistas panor√°micas\", en: \"Terrace with panoramic views\" },\r\n    { es: \"Exterior del hotel al atardecer\", en: \"Hotel exterior at sunset\" },\r\n    { es: \"Entrada principal elegante\", en: \"Elegant main entrance\" },\r\n    { es: \"Jardines exteriores cuidados\", en: \"Well-kept outdoor gardens\" },\r\n    { es: \"Zona exterior con palmeras\", en: \"Outdoor area with palm trees\" },\r\n    { es: \"Fachada contempor√°nea del hotel\", en: \"Contemporary hotel facade\" },\r\n    { es: \"Acceso exterior con iluminaci√≥n c√°lida\", en: \"Exterior access with warm lighting\" },\r\n\r\n    // ‚≠ê COMBINADOS EXTERIOR + PISCINA\r\n    { es: \"Fachada del hotel con piscina exterior\", en: \"Hotel facade with outdoor pool\" },\r\n    { es: \"Hotel con piscina y vistas al mar\", en: \"Hotel with pool and sea view\" },\r\n    { es: \"Fachada del hotel frente a la piscina\", en: \"Hotel facade facing the pool\" },\r\n    { es: \"Zona exterior con piscina y palmeras\", en: \"Outdoor area with pool and palm trees\" },\r\n    { es: \"Hotel con piscina iluminada al atardecer\", en: \"Hotel with illuminated pool at sunset\" },\r\n    { es: \"Hotel con piscina y ambiente tropical\", en: \"Hotel with pool and tropical ambience\" },\r\n    { es: \"Fachada del hotel con piscina y terraza\", en: \"Hotel facade with pool and terrace\" },\r\n    { es: \"Hotel con piscina y vistas al oc√©ano\", en: \"Hotel with pool and ocean view\" },\r\n    { es: \"Zona exterior del hotel con piscina\", en: \"Hotel outdoor area with pool\" },\r\n    { es: \"Hotel con piscina y jardines exteriores\", en: \"Hotel with pool and outdoor gardens\" },\r\n  ],\r\n\r\n  // ============================\r\n  // üüß HABITACIONES\r\n  // ============================\r\n  habitaciones: [\r\n    { es: \"Habitaci√≥n doble luminosa\", en: \"Bright double room\" },\r\n    { es: \"Habitaci√≥n con vistas al mar\", en: \"Room with sea view\" },\r\n    { es: \"Habitaci√≥n moderna y acogedora\", en: \"Modern and cozy room\" },\r\n    { es: \"Suite amplia con decoraci√≥n elegante\", en: \"Spacious suite with elegant decor\" },\r\n    { es: \"Habitaci√≥n con balc√≥n privado\", en: \"Room with private balcony\" },\r\n    { es: \"Dormitorio con luz natural\", en: \"Bedroom with natural light\" },\r\n    { es: \"Habitaci√≥n minimalista y moderna\", en: \"Minimalist modern room\" },\r\n    { es: \"Suite con zona de estar\", en: \"Suite with living area\" },\r\n    { es: \"Habitaci√≥n con cama king-size\", en: \"Room with king-size bed\" },\r\n    { es: \"Habitaci√≥n decorada con tonos c√°lidos\", en: \"Room decorated with warm tones\" },\r\n  ],\r\n\r\n  // ============================\r\n  // üü™ SPA\r\n  // ============================\r\n  spa: [\r\n    { es: \"Spa con iluminaci√≥n relajante\", en: \"Spa with relaxing lighting\" },\r\n    { es: \"Spa moderno con ambiente c√°lido\", en: \"Modern spa with warm ambience\" },\r\n    { es: \"Zona de spa con luz tenue\", en: \"Spa area with soft lighting\" },\r\n    { es: \"Spa elegante con decoraci√≥n natural\", en: \"Elegant spa with natural decor\" },\r\n    { es: \"Spa con jacuzzi iluminado\", en: \"Spa with illuminated jacuzzi\" },\r\n    { es: \"Zona de masajes con luz suave\", en: \"Massage area with soft light\" },\r\n    { es: \"Spa con ambiente zen\", en: \"Spa with zen ambience\" },\r\n    { es: \"Spa con piscina climatizada\", en: \"Spa with heated pool\" },\r\n    { es: \"Spa con decoraci√≥n en madera\", en: \"Spa with wooden decor\" },\r\n    { es: \"Spa con velas y ambiente √≠ntimo\", en: \"Spa with candles and intimate ambience\" },\r\n  ],\r\n\r\n  // ============================\r\n  // üü® RESTAURANTE\r\n  // ============================\r\n  restaurante: [\r\n    { es: \"Restaurante elegante y moderno\", en: \"Elegant modern restaurant\" },\r\n    { es: \"Restaurante con decoraci√≥n cl√°sica\", en: \"Restaurant with classic decor\" },\r\n    { es: \"Restaurante luminoso y acogedor\", en: \"Bright and cozy restaurant\" },\r\n    { es: \"Restaurante con mesas bien dispuestas\", en: \"Restaurant with well-arranged tables\" },\r\n    { es: \"Restaurante con iluminaci√≥n c√°lida\", en: \"Restaurant with warm lighting\" },\r\n    { es: \"Restaurante con ambiente sofisticado\", en: \"Restaurant with sophisticated ambience\" },\r\n    { es: \"Restaurante con decoraci√≥n contempor√°nea\", en: \"Restaurant with contemporary decor\" },\r\n    { es: \"Restaurante con vistas exteriores\", en: \"Restaurant with outdoor views\" },\r\n    { es: \"Restaurante con mesas de madera\", en: \"Restaurant with wooden tables\" },\r\n    { es: \"Restaurante con estilo minimalista\", en: \"Minimalist style restaurant\" },\r\n  ],\r\n\r\n  // ============================\r\n  // üü´ INTERIOR\r\n  // ============================\r\n  interior: [\r\n    { es: \"Interior moderno y luminoso\", en: \"Modern bright interior\" },\r\n    { es: \"Zona interior con decoraci√≥n elegante\", en: \"Interior area with elegant decor\" },\r\n    { es: \"Espacio interior acogedor\", en: \"Cozy interior space\" },\r\n    { es: \"Pasillo interior iluminado\", en: \"Illuminated interior hallway\" },\r\n    { es: \"Zona interior con mobiliario moderno\", en: \"Interior with modern furniture\" },\r\n    { es: \"Interior con detalles en madera\", en: \"Interior with wooden details\" },\r\n    { es: \"Espacio interior minimalista\", en: \"Minimalist interior space\" },\r\n    { es: \"Zona interior amplia y di√°fana\", en: \"Wide open interior area\" },\r\n    { es: \"Interior con iluminaci√≥n c√°lida\", en: \"Interior with warm lighting\" },\r\n    { es: \"Vest√≠bulo interior elegante\", en: \"Elegant interior lobby\" },\r\n  ],\r\n\r\n  // ============================\r\n  // üü¶ SALAS COMUNES\r\n  // ============================\r\n  salas_comunes: [\r\n    { es: \"Sala com√∫n moderna y acogedora\", en: \"Modern cozy common room\" },\r\n    { es: \"Zona com√∫n con sof√°s c√≥modos\", en: \"Common area with comfortable sofas\" },\r\n    { es: \"Sala de estar amplia y luminosa\", en: \"Bright spacious living room\" },\r\n    { es: \"Espacio com√∫n con decoraci√≥n elegante\", en: \"Common space with elegant decor\" },\r\n    { es: \"Sala com√∫n con luz natural\", en: \"Common room with natural light\" },\r\n    { es: \"Zona lounge moderna\", en: \"Modern lounge area\" },\r\n    { es: \"Sala com√∫n con mobiliario contempor√°neo\", en: \"Common room with contemporary furniture\" },\r\n    { es: \"Espacio compartido con ambiente relajado\", en: \"Shared space with relaxed ambience\" },\r\n    { es: \"Sala com√∫n con vistas exteriores\", en: \"Common room with outdoor views\" },\r\n    { es: \"Zona com√∫n con decoraci√≥n minimalista\", en: \"Minimalist common area\" },\r\n  ],\r\n\r\n  // ============================\r\n  // üü´ OTROS\r\n  // ============================\r\n  otros: [\r\n    { es: \"Espacio del hotel\", en: \"Hotel space\" },\r\n    { es: \"Zona del hotel\", en: \"Hotel area\" },\r\n    { es: \"√Årea del hotel bien iluminada\", en: \"Well-lit hotel area\" },\r\n    { es: \"Zona del hotel con decoraci√≥n moderna\", en: \"Hotel area with modern decor\" },\r\n    { es: \"Espacio funcional del hotel\", en: \"Functional hotel space\" },\r\n    { es: \"√Årea del hotel con luz natural\", en: \"Hotel area with natural light\" },\r\n  ],\r\n};\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 692, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/achra/proyectos/app-hotel-nueva/src/lib/generateDynamicTitles.ts"],"sourcesContent":["// src/lib/generateDynamicTitles.ts\r\n\r\nexport function generateDynamicTitles(tags: string[]) {\r\n  // Aqu√≠ los tags ya vienen como string[], pero aseguramos min√∫sculas\r\n  const normalized = tags.map((t) => t.toLowerCase());\r\n  const has = (key: string) => normalized.includes(key);\r\n\r\n  // Piscinas\r\n  const hasPool = has(\"pool\") || has(\"swimming pool\") || has(\"outdoor pool\") || has(\"indoor pool\");\r\n  const hasInfinityPool = has(\"infinity pool\");\r\n  const hasIndoorPool = has(\"indoor pool\");\r\n  const hasOutdoorPool = has(\"outdoor pool\");\r\n\r\n  // Vistas\r\n  const hasSea = has(\"sea\") || has(\"ocean\") || has(\"beach\") || has(\"sea view\");\r\n  const hasCityView = has(\"city view\");\r\n  const hasMountainView = has(\"mountains\");\r\n\r\n  // Ambiente\r\n  const hasSunset = has(\"sunset\");\r\n  const hasNight = has(\"night\") || has(\"illuminated\");\r\n\r\n  // Spa\r\n  const hasSpa =\r\n    has(\"spa\") ||\r\n    has(\"spa bed\") ||\r\n    has(\"massage table\") ||\r\n    has(\"massage room\") ||\r\n    has(\"treatment room\") ||\r\n    has(\"wellness area\") ||\r\n    has(\"relaxation area\");\r\n\r\n  const hasSauna = has(\"sauna\") || has(\"steam room\") || has(\"hammam\");\r\n  const hasJacuzzi = has(\"jacuzzi\") || has(\"hot tub\");\r\n\r\n  // Restaurantes y bares\r\n  const hasRestaurant = has(\"restaurant\") || has(\"buffet\") || has(\"dining room\");\r\n  const hasBuffet = has(\"buffet\");\r\n  const hasRooftopBar = has(\"rooftop bar\");\r\n  const hasBar = has(\"bar\") || has(\"cocktail bar\") || has(\"lounge bar\");\r\n\r\n  // Habitaciones\r\n  const hasRoom =\r\n    has(\"hotel room\") || has(\"bedroom\") || has(\"suite\") || has(\"family room\");\r\n\r\n  const hasBalcony = has(\"balcony\") || has(\"terrace\");\r\n\r\n  // Zonas comunes\r\n  const hasLobby = has(\"lobby\") || has(\"reception\");\r\n  const hasLounge = has(\"lounge\") || has(\"common area\");\r\n  const hasCoworking = has(\"coworking area\");\r\n  const hasMeetingRoom = has(\"meeting room\") || has(\"conference room\");\r\n  const hasKidsClub = has(\"kids club\");\r\n\r\n  const titles: string[] = [];\r\n\r\n  // üèä Piscinas (versi√≥n mejorada)\r\n  if (hasPool || hasInfinityPool || hasOutdoorPool || hasIndoorPool) {\r\n    if (hasInfinityPool && hasSea && hasSunset) {\r\n      titles.push(\"Piscina infinita con vistas al mar al atardecer\");\r\n      titles.push(\"Infinity pool con vistas al oc√©ano al atardecer\");\r\n    }\r\n\r\n    if (hasInfinityPool && hasSea) {\r\n      titles.push(\"Piscina infinita con vistas al mar\");\r\n      titles.push(\"Infinity pool frente al oc√©ano\");\r\n    }\r\n\r\n    if (hasInfinityPool) {\r\n      titles.push(\"Piscina infinita del hotel\");\r\n    }\r\n\r\n    if (hasOutdoorPool && hasSea) {\r\n      titles.push(\"Piscina exterior con vistas al mar\");\r\n      titles.push(\"Piscina al aire libre frente al oc√©ano\");\r\n    }\r\n\r\n    if (hasOutdoorPool && hasSunset) {\r\n      titles.push(\"Piscina exterior iluminada al atardecer\");\r\n    }\r\n\r\n    if (hasOutdoorPool) {\r\n      titles.push(\"Piscina exterior del hotel\");\r\n    }\r\n\r\n    if (hasIndoorPool) {\r\n      titles.push(\"Piscina interior climatizada\");\r\n    }\r\n\r\n    titles.push(\"Piscina del hotel\");\r\n  }\r\n\r\n  // üíÜ Spa (versi√≥n mejorada)\r\n  if (hasSpa) {\r\n    titles.push(\"Sala de masajes con camillas preparadas\");\r\n    titles.push(\"Camillas de masaje en un spa acogedor\");\r\n    titles.push(\"Sala de tratamientos con iluminaci√≥n c√°lida\");\r\n    titles.push(\"Zona de spa con camillas y toallas preparadas\");\r\n    titles.push(\"Espacio de bienestar con camillas de masaje\");\r\n    titles.push(\"Sala de spa lista para tratamientos relajantes\");\r\n\r\n    if (hasSauna) titles.push(\"Spa con sauna y zona de relajaci√≥n\");\r\n    if (hasJacuzzi) titles.push(\"Spa con jacuzzi y camillas de masaje\");\r\n  }\r\n\r\n  // üçΩÔ∏è Restaurantes\r\n  if (hasRestaurant) {\r\n    if (hasSea) titles.push(\"Restaurante con vistas al mar\");\r\n    if (hasBuffet) titles.push(\"Buffet del hotel\");\r\n    if (hasBalcony) titles.push(\"Restaurante con terraza exterior\");\r\n    titles.push(\"Restaurante elegante del hotel\");\r\n  }\r\n\r\n  // üç∏ Bares\r\n  if (hasRooftopBar) {\r\n    if (hasCityView) titles.push(\"Rooftop bar con vistas a la ciudad\");\r\n    else titles.push(\"Rooftop bar del hotel\");\r\n  }\r\n\r\n  if (hasBar) {\r\n    if (hasNight) titles.push(\"Bar iluminado por la noche\");\r\n    titles.push(\"Bar del hotel con ambiente moderno\");\r\n  }\r\n\r\n  // üõèÔ∏è Habitaciones\r\n  if (hasRoom) {\r\n    if (hasSea) titles.push(\"Habitaci√≥n con vistas al mar\");\r\n    if (hasBalcony) titles.push(\"Habitaci√≥n con balc√≥n privado\");\r\n    titles.push(\"Habitaci√≥n moderna y luminosa\");\r\n  }\r\n\r\n  // üõãÔ∏è Zonas comunes\r\n  if (hasLobby) titles.push(\"Lobby moderno del hotel\");\r\n  if (hasLounge) titles.push(\"Zona com√∫n con ambiente acogedor\");\r\n  if (hasCoworking) titles.push(\"Zona coworking del hotel\");\r\n  if (hasMeetingRoom) titles.push(\"Sala de reuniones moderna\");\r\n  if (hasKidsClub) titles.push(\"Kids club del hotel\");\r\n\r\n  // üåÖ Exterior\r\n  if (has(\"exterior\") || has(\"facade\")) {\r\n    if (hasSea) titles.push(\"Fachada del hotel con vistas al mar\");\r\n    titles.push(\"Fachada exterior del hotel\");\r\n  }\r\n\r\n  if (titles.length === 0) {\r\n    titles.push(\"Zona del hotel\");\r\n  }\r\n\r\n  return titles;\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 813, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/achra/proyectos/app-hotel-nueva/src/lib/sceneWeights.ts"],"sourcesContent":["// src/lib/sceneWeights.ts\r\n\r\nexport interface WeightedElement {\r\n  key: string;\r\n  weight: number;\r\n}\r\n\r\nexport interface SceneWeights {\r\n  scene: string;\r\n  elements: WeightedElement[];\r\n}\r\n\r\nexport function computeSceneWeights(tags: string[]): SceneWeights {\r\n  // Normalizamos tags\r\n  const normalized = tags.map((t) => t.toLowerCase()).filter(Boolean);\r\n\r\n  const has = (key: string) => normalized.includes(key);\r\n\r\n  const weights: WeightedElement[] = [];\r\n\r\n  // Piscina\r\n  if (has(\"infinity pool\")) weights.push({ key: \"infinity_pool\", weight: 1.0 });\r\n  if (has(\"outdoor pool\")) weights.push({ key: \"outdoor_pool\", weight: 0.9 });\r\n  if (has(\"indoor pool\")) weights.push({ key: \"indoor_pool\", weight: 0.8 });\r\n  if (has(\"pool\")) weights.push({ key: \"pool\", weight: 0.7 });\r\n\r\n  // Vistas\r\n  if (has(\"sea\") || has(\"ocean\") || has(\"sea view\"))\r\n    weights.push({ key: \"sea_view\", weight: 0.9 });\r\n  if (has(\"city view\")) weights.push({ key: \"city_view\", weight: 0.7 });\r\n  if (has(\"mountains\")) weights.push({ key: \"mountain_view\", weight: 0.6 });\r\n\r\n  // Ambiente\r\n  if (has(\"sunset\")) weights.push({ key: \"sunset\", weight: 0.8 });\r\n  if (has(\"night\") || has(\"illuminated\"))\r\n    weights.push({ key: \"night\", weight: 0.7 });\r\n\r\n  // Spa\r\n  if (has(\"massage table\")) weights.push({ key: \"massage_table\", weight: 1.0 });\r\n  if (has(\"spa bed\")) weights.push({ key: \"spa_bed\", weight: 0.9 });\r\n  if (has(\"sauna\")) weights.push({ key: \"sauna\", weight: 0.7 });\r\n  if (has(\"jacuzzi\")) weights.push({ key: \"jacuzzi\", weight: 0.8 });\r\n\r\n  // Restaurante\r\n  if (has(\"buffet\")) weights.push({ key: \"buffet\", weight: 0.9 });\r\n  if (has(\"terrace restaurant\"))\r\n    weights.push({ key: \"terrace_restaurant\", weight: 0.8 });\r\n  if (has(\"restaurant\"))\r\n    weights.push({ key: \"restaurant\", weight: 0.7 });\r\n\r\n  // Bar\r\n  if (has(\"rooftop bar\")) weights.push({ key: \"rooftop_bar\", weight: 1.0 });\r\n  if (has(\"cocktail bar\")) weights.push({ key: \"cocktail_bar\", weight: 0.8 });\r\n  if (has(\"bar\")) weights.push({ key: \"bar\", weight: 0.7 });\r\n\r\n  // Habitaciones\r\n  if (has(\"suite\")) weights.push({ key: \"suite\", weight: 1.0 });\r\n  if (has(\"balcony\")) weights.push({ key: \"balcony\", weight: 0.8 });\r\n  if (has(\"hotel room\") || has(\"bedroom\") || has(\"family room\"))\r\n    weights.push({ key: \"room\", weight: 0.9 });\r\n\r\n  // Zonas comunes\r\n  if (has(\"lobby\")) weights.push({ key: \"lobby\", weight: 0.9 });\r\n  if (has(\"coworking area\"))\r\n    weights.push({ key: \"coworking\", weight: 0.7 });\r\n  if (has(\"meeting room\") || has(\"conference room\"))\r\n    weights.push({ key: \"meeting_room\", weight: 0.8 });\r\n\r\n  // Exterior\r\n  if (has(\"facade\") || has(\"exterior\"))\r\n    weights.push({ key: \"facade\", weight: 0.6 });\r\n\r\n  // Ordenar por peso\r\n  weights.sort((a, b) => b.weight - a.weight);\r\n\r\n  // ‚≠ê CORRECCI√ìN INTELIGENTE\r\n  // Si hay fachada/exterior/balc√≥n y tambi√©n suite/hotel room,\r\n  // priorizamos EXTERIOR porque CLIP suele confundir balcones con habitaciones.\r\n  const hasExterior =\r\n    normalized.includes(\"facade\") ||\r\n    normalized.includes(\"exterior\") ||\r\n    normalized.includes(\"balcony\") ||\r\n    normalized.includes(\"terrace\");\r\n\r\n  const hasRoom =\r\n    normalized.includes(\"suite\") ||\r\n    normalized.includes(\"hotel room\") ||\r\n    normalized.includes(\"bedroom\") ||\r\n    normalized.includes(\"family room\");\r\n\r\n  if (hasExterior && hasRoom) {\r\n    return {\r\n      scene: \"exterior\",\r\n      elements: weights,\r\n    };\r\n  }\r\n\r\n  // Escena dominante normal\r\n  const scene =\r\n    weights.length > 0 ? detectSceneFromWeights(weights[0].key) : \"otros\";\r\n\r\n  return { scene, elements: weights };\r\n}\r\n\r\nfunction detectSceneFromWeights(key: string): string {\r\n  if (key.includes(\"pool\")) return \"piscina\";\r\n  if (key.includes(\"spa\") || key.includes(\"massage\")) return \"spa\";\r\n  if (key.includes(\"buffet\") || key.includes(\"restaurant\")) return \"restaurante\";\r\n  if (key.includes(\"bar\")) return \"bar\";\r\n  if (key.includes(\"suite\") || key.includes(\"room\")) return \"habitacion\";\r\n  if (key.includes(\"lobby\") || key.includes(\"meeting\")) return \"zonas_comunes\";\r\n  if (key.includes(\"facade\")) return \"exterior\";\r\n  return \"otros\";\r\n}\r\n"],"names":[],"mappings":"AAAA,0BAA0B;;;;;AAYnB,SAAS,oBAAoB,IAAc;IAChD,oBAAoB;IACpB,MAAM,aAAa,KAAK,GAAG,CAAC,CAAC,IAAM,EAAE,WAAW,IAAI,MAAM,CAAC;IAE3D,MAAM,MAAM,CAAC,MAAgB,WAAW,QAAQ,CAAC;IAEjD,MAAM,UAA6B,EAAE;IAErC,UAAU;IACV,IAAI,IAAI,kBAAkB,QAAQ,IAAI,CAAC;QAAE,KAAK;QAAiB,QAAQ;IAAI;IAC3E,IAAI,IAAI,iBAAiB,QAAQ,IAAI,CAAC;QAAE,KAAK;QAAgB,QAAQ;IAAI;IACzE,IAAI,IAAI,gBAAgB,QAAQ,IAAI,CAAC;QAAE,KAAK;QAAe,QAAQ;IAAI;IACvE,IAAI,IAAI,SAAS,QAAQ,IAAI,CAAC;QAAE,KAAK;QAAQ,QAAQ;IAAI;IAEzD,SAAS;IACT,IAAI,IAAI,UAAU,IAAI,YAAY,IAAI,aACpC,QAAQ,IAAI,CAAC;QAAE,KAAK;QAAY,QAAQ;IAAI;IAC9C,IAAI,IAAI,cAAc,QAAQ,IAAI,CAAC;QAAE,KAAK;QAAa,QAAQ;IAAI;IACnE,IAAI,IAAI,cAAc,QAAQ,IAAI,CAAC;QAAE,KAAK;QAAiB,QAAQ;IAAI;IAEvE,WAAW;IACX,IAAI,IAAI,WAAW,QAAQ,IAAI,CAAC;QAAE,KAAK;QAAU,QAAQ;IAAI;IAC7D,IAAI,IAAI,YAAY,IAAI,gBACtB,QAAQ,IAAI,CAAC;QAAE,KAAK;QAAS,QAAQ;IAAI;IAE3C,MAAM;IACN,IAAI,IAAI,kBAAkB,QAAQ,IAAI,CAAC;QAAE,KAAK;QAAiB,QAAQ;IAAI;IAC3E,IAAI,IAAI,YAAY,QAAQ,IAAI,CAAC;QAAE,KAAK;QAAW,QAAQ;IAAI;IAC/D,IAAI,IAAI,UAAU,QAAQ,IAAI,CAAC;QAAE,KAAK;QAAS,QAAQ;IAAI;IAC3D,IAAI,IAAI,YAAY,QAAQ,IAAI,CAAC;QAAE,KAAK;QAAW,QAAQ;IAAI;IAE/D,cAAc;IACd,IAAI,IAAI,WAAW,QAAQ,IAAI,CAAC;QAAE,KAAK;QAAU,QAAQ;IAAI;IAC7D,IAAI,IAAI,uBACN,QAAQ,IAAI,CAAC;QAAE,KAAK;QAAsB,QAAQ;IAAI;IACxD,IAAI,IAAI,eACN,QAAQ,IAAI,CAAC;QAAE,KAAK;QAAc,QAAQ;IAAI;IAEhD,MAAM;IACN,IAAI,IAAI,gBAAgB,QAAQ,IAAI,CAAC;QAAE,KAAK;QAAe,QAAQ;IAAI;IACvE,IAAI,IAAI,iBAAiB,QAAQ,IAAI,CAAC;QAAE,KAAK;QAAgB,QAAQ;IAAI;IACzE,IAAI,IAAI,QAAQ,QAAQ,IAAI,CAAC;QAAE,KAAK;QAAO,QAAQ;IAAI;IAEvD,eAAe;IACf,IAAI,IAAI,UAAU,QAAQ,IAAI,CAAC;QAAE,KAAK;QAAS,QAAQ;IAAI;IAC3D,IAAI,IAAI,YAAY,QAAQ,IAAI,CAAC;QAAE,KAAK;QAAW,QAAQ;IAAI;IAC/D,IAAI,IAAI,iBAAiB,IAAI,cAAc,IAAI,gBAC7C,QAAQ,IAAI,CAAC;QAAE,KAAK;QAAQ,QAAQ;IAAI;IAE1C,gBAAgB;IAChB,IAAI,IAAI,UAAU,QAAQ,IAAI,CAAC;QAAE,KAAK;QAAS,QAAQ;IAAI;IAC3D,IAAI,IAAI,mBACN,QAAQ,IAAI,CAAC;QAAE,KAAK;QAAa,QAAQ;IAAI;IAC/C,IAAI,IAAI,mBAAmB,IAAI,oBAC7B,QAAQ,IAAI,CAAC;QAAE,KAAK;QAAgB,QAAQ;IAAI;IAElD,WAAW;IACX,IAAI,IAAI,aAAa,IAAI,aACvB,QAAQ,IAAI,CAAC;QAAE,KAAK;QAAU,QAAQ;IAAI;IAE5C,mBAAmB;IACnB,QAAQ,IAAI,CAAC,CAAC,GAAG,IAAM,EAAE,MAAM,GAAG,EAAE,MAAM;IAE1C,2BAA2B;IAC3B,6DAA6D;IAC7D,8EAA8E;IAC9E,MAAM,cACJ,WAAW,QAAQ,CAAC,aACpB,WAAW,QAAQ,CAAC,eACpB,WAAW,QAAQ,CAAC,cACpB,WAAW,QAAQ,CAAC;IAEtB,MAAM,UACJ,WAAW,QAAQ,CAAC,YACpB,WAAW,QAAQ,CAAC,iBACpB,WAAW,QAAQ,CAAC,cACpB,WAAW,QAAQ,CAAC;IAEtB,IAAI,eAAe,SAAS;QAC1B,OAAO;YACL,OAAO;YACP,UAAU;QACZ;IACF;IAEA,0BAA0B;IAC1B,MAAM,QACJ,QAAQ,MAAM,GAAG,IAAI,uBAAuB,OAAO,CAAC,EAAE,CAAC,GAAG,IAAI;IAEhE,OAAO;QAAE;QAAO,UAAU;IAAQ;AACpC;AAEA,SAAS,uBAAuB,GAAW;IACzC,IAAI,IAAI,QAAQ,CAAC,SAAS,OAAO;IACjC,IAAI,IAAI,QAAQ,CAAC,UAAU,IAAI,QAAQ,CAAC,YAAY,OAAO;IAC3D,IAAI,IAAI,QAAQ,CAAC,aAAa,IAAI,QAAQ,CAAC,eAAe,OAAO;IACjE,IAAI,IAAI,QAAQ,CAAC,QAAQ,OAAO;IAChC,IAAI,IAAI,QAAQ,CAAC,YAAY,IAAI,QAAQ,CAAC,SAAS,OAAO;IAC1D,IAAI,IAAI,QAAQ,CAAC,YAAY,IAAI,QAAQ,CAAC,YAAY,OAAO;IAC7D,IAAI,IAAI,QAAQ,CAAC,WAAW,OAAO;IACnC,OAAO;AACT"}},
    {"offset": {"line": 970, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/achra/proyectos/app-hotel-nueva/src/lib/normalizeTags.ts"],"sourcesContent":["// src/lib/normalizeTags.ts\r\n\r\nexport function normalizeTags(rawTags: any[]) {\r\n  const normalized: string[] = [];\r\n\r\n  for (const t of rawTags) {\r\n    const label = (t.label || \"\").toLowerCase();\r\n\r\n    // ------------------------------------------------------------\r\n    // üèä Piscinas\r\n    // ------------------------------------------------------------\r\n    if (label.includes(\"infinity pool\")) normalized.push(\"infinity pool\");\r\n    if (label.includes(\"outdoor pool\")) normalized.push(\"outdoor pool\");\r\n    if (label.includes(\"indoor pool\")) normalized.push(\"indoor pool\");\r\n    if (label.includes(\"pool\")) normalized.push(\"pool\");\r\n\r\n    // ------------------------------------------------------------\r\n    // üåä Vistas\r\n    // ------------------------------------------------------------\r\n    if (label.includes(\"sea\") || label.includes(\"ocean\")) normalized.push(\"sea view\");\r\n\r\n    // ------------------------------------------------------------\r\n    // üíÜ Spa (todas las variantes reales del backend)\r\n    // ------------------------------------------------------------\r\n    if (label.includes(\"spa\")) normalized.push(\"spa\");\r\n    if (label.includes(\"massage table\")) normalized.push(\"massage table\");\r\n    if (label.includes(\"massage room\")) normalized.push(\"massage room\");\r\n    if (label.includes(\"massage\")) normalized.push(\"massage table\");\r\n    if (label.includes(\"treatment room\")) normalized.push(\"treatment room\");\r\n    if (label.includes(\"treatment\")) normalized.push(\"treatment room\");\r\n    if (label.includes(\"relaxation\")) normalized.push(\"relaxation area\");\r\n    if (label.includes(\"wellness\")) normalized.push(\"wellness area\");\r\n    if (label.includes(\"sauna\")) normalized.push(\"sauna\");\r\n    if (label.includes(\"steam room\")) normalized.push(\"steam room\");\r\n    if (label.includes(\"hammam\")) normalized.push(\"hammam\");\r\n    if (label.includes(\"jacuzzi\")) normalized.push(\"jacuzzi\");\r\n\r\n    // ------------------------------------------------------------\r\n    // üõèÔ∏è Habitaciones\r\n    // ------------------------------------------------------------\r\n    if (label.includes(\"suite\")) normalized.push(\"suite\");\r\n    if (label.includes(\"room\")) normalized.push(\"hotel room\");\r\n    if (label.includes(\"bedroom\")) normalized.push(\"hotel room\");\r\n\r\n    // ------------------------------------------------------------\r\n    // üçΩÔ∏è Restaurantes\r\n    // ------------------------------------------------------------\r\n    if (label.includes(\"restaurant\")) normalized.push(\"restaurant\");\r\n    if (label.includes(\"buffet\")) normalized.push(\"buffet\");\r\n    if (label.includes(\"dining room\")) normalized.push(\"dining room\");\r\n\r\n    // ------------------------------------------------------------\r\n    // üç∏ Bares\r\n    // ------------------------------------------------------------\r\n    if (label.includes(\"rooftop bar\")) normalized.push(\"rooftop bar\");\r\n    if (label.includes(\"cocktail bar\")) normalized.push(\"cocktail bar\");\r\n    if (label.includes(\"bar\")) normalized.push(\"bar\");\r\n\r\n    // ------------------------------------------------------------\r\n    // üõãÔ∏è Zonas comunes\r\n    // ------------------------------------------------------------\r\n    if (label.includes(\"lobby\")) normalized.push(\"lobby\");\r\n    if (label.includes(\"reception\")) normalized.push(\"lobby\");\r\n    if (label.includes(\"common area\")) normalized.push(\"common area\");\r\n    if (label.includes(\"coworking\")) normalized.push(\"coworking area\");\r\n    if (label.includes(\"meeting room\")) normalized.push(\"meeting room\");\r\n    if (label.includes(\"conference room\")) normalized.push(\"meeting room\");\r\n    if (label.includes(\"kids club\")) normalized.push(\"kids club\");\r\n\r\n    // ------------------------------------------------------------\r\n    // üå¥ Exterior\r\n    // ------------------------------------------------------------\r\n    if (label.includes(\"exterior\")) normalized.push(\"exterior\");\r\n    if (label.includes(\"facade\")) normalized.push(\"exterior\");\r\n    if (label.includes(\"building\")) normalized.push(\"exterior\");\r\n    if (label.includes(\"terrace\")) normalized.push(\"terrace\");\r\n    if (label.includes(\"balcony\")) normalized.push(\"balcony\");\r\n\r\n    // ------------------------------------------------------------\r\n    // Fallback\r\n    // ------------------------------------------------------------\r\n    normalized.push(label);\r\n  }\r\n\r\n  return normalized;\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1052, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/achra/proyectos/app-hotel-nueva/src/lib/generateAiTitleV2.ts"],"sourcesContent":["// src/lib/generateAiTitle.ts\r\n\r\nimport { TITLE_TEMPLATES } from \"./aiTitleTemplates\";\r\nimport { generateDynamicTitles } from \"./generateDynamicTitles\";\r\nimport { computeSceneWeights } from \"./sceneWeights\";\r\nimport { normalizeTags } from \"./normalizeTags\"; // ‚≠ê IMPORTANTE\r\n\r\nconst CLIP_API_URL =\r\n  process.env.NEXT_PUBLIC_CLIP_URL || \"http://localhost:8000/rank\";\r\n\r\n/**\r\n * Genera un t√≠tulo usando:\r\n * 1. Scene Weighting (prioridad real basada en pesos)\r\n * 2. T√≠tulos din√°micos basados en los tags detectados\r\n * 3. Plantillas fijas seg√∫n categor√≠a o escena\r\n * 4. CLIP para elegir el mejor t√≠tulo\r\n */\r\nexport async function generateAiTitleFromClip(\r\n  imageUrl: string,\r\n  category?: string | null,\r\n  tags?: any[]\r\n) {\r\n  // ------------------------------------------------------------\r\n  // ‚≠ê Normalizar tags antes de todo\r\n  // ------------------------------------------------------------\r\n  const normalizedTags = normalizeTags(tags || []);\r\n  console.log(\"üîß Normalized tags:\", normalizedTags);\r\n\r\n  // ------------------------------------------------------------\r\n  // 1. Scene Weighting: detectar escena dominante + pesos\r\n  // ------------------------------------------------------------\r\n  const { scene, elements } = computeSceneWeights(normalizedTags);\r\n  const normalizedCategory = (category || \"\").toLowerCase();\r\n\r\n  console.log(\"üéØ Scene detected:\", scene);\r\n  console.log(\"üìä Scene weights:\", elements);\r\n\r\n  // ------------------------------------------------------------\r\n  // 2. T√≠tulos din√°micos basados en tags normalizados\r\n  // ------------------------------------------------------------\r\n  const dynamicTitles = generateDynamicTitles(normalizedTags);\r\n\r\n  console.log(\"üß† Dynamic titles:\", dynamicTitles);\r\n\r\n  // ------------------------------------------------------------\r\n  // 3. Plantillas fijas seg√∫n categor√≠a o escena\r\n  // ------------------------------------------------------------\r\n  let templates;\r\n\r\n  if (normalizedCategory === \"piscina\" || scene === \"piscina\") {\r\n    templates = [\r\n      ...TITLE_TEMPLATES.piscina,\r\n      ...TITLE_TEMPLATES.exterior,\r\n    ];\r\n  } else if (TITLE_TEMPLATES[scene]) {\r\n    templates = TITLE_TEMPLATES[scene];\r\n  } else {\r\n    templates =\r\n      TITLE_TEMPLATES[normalizedCategory] || TITLE_TEMPLATES[\"otros\"];\r\n  }\r\n\r\n  const templateSpanish = templates.map((t) => t.es);\r\n  const templateEnglish = templates.map((t) => t.en);\r\n\r\n  console.log(\"üìö Template Spanish:\", templateSpanish);\r\n  console.log(\"üìö Template English:\", templateEnglish);\r\n\r\n  // ------------------------------------------------------------\r\n  // 4. Fusionar din√°micos + plantillas\r\n  // ------------------------------------------------------------\r\n  const spanishCandidates = [...dynamicTitles, ...templateSpanish];\r\n  const englishCandidates = [\r\n    ...dynamicTitles.map((t) => translateToEnglish(t)),\r\n    ...templateEnglish,\r\n  ];\r\n\r\n  console.log(\"üá™üá∏ Final Spanish candidates:\", spanishCandidates);\r\n  console.log(\"üá¨üáß Final English candidates:\", englishCandidates);\r\n\r\n  // ------------------------------------------------------------\r\n  // 5. Llamar a CLIP\r\n  // ------------------------------------------------------------\r\n  const res = await fetch(CLIP_API_URL, {\r\n    method: \"POST\",\r\n    headers: { \"Content-Type\": \"application/json\" },\r\n    body: JSON.stringify({\r\n      url: imageUrl,\r\n      texts: englishCandidates,\r\n    }),\r\n  });\r\n\r\n  if (!res.ok) {\r\n    console.error(\"‚ùå Error llamando a CLIP /rank:\", await res.text());\r\n    return spanishCandidates[0];\r\n  }\r\n\r\n  const ranked = await res.json();\r\n\r\n  console.log(\"üèÜ CLIP ranking:\", ranked);\r\n\r\n  const bestEnglish = ranked[0]?.label;\r\n\r\n  if (!bestEnglish) return spanishCandidates[0];\r\n\r\n  // ------------------------------------------------------------\r\n  // 6. Buscar equivalente en espa√±ol\r\n  // ------------------------------------------------------------\r\n  const templateMatch = templates.find((t) => t.en === bestEnglish);\r\n  if (templateMatch) {\r\n    console.log(\"‚ú® Best match (template):\", templateMatch.es);\r\n    return templateMatch.es;\r\n  }\r\n\r\n  const index = englishCandidates.indexOf(bestEnglish);\r\n  console.log(\"‚ú® Best match (dynamic):\", spanishCandidates[index]);\r\n\r\n  return spanishCandidates[index] || spanishCandidates[0];\r\n}\r\n\r\n// ------------------------------------------------------------\r\n// ‚≠ê Traducci√≥n avanzada ES ‚Üí EN para CLIP\r\n// ------------------------------------------------------------\r\nfunction translateToEnglish(spanish: string): string {\r\n  let en = spanish.toLowerCase();\r\n\r\n  // Piscina avanzada\r\n  en = en.replace(\"piscina infinita con vistas al mar al atardecer\", \"infinity pool with ocean view at sunset\");\r\n  en = en.replace(\"infinity pool con vistas al oc√©ano al atardecer\", \"infinity pool with ocean view at sunset\");\r\n\r\n  en = en.replace(\"piscina infinita con vistas al mar\", \"infinity pool with sea view\");\r\n  en = en.replace(\"infinity pool frente al oc√©ano\", \"infinity pool facing the ocean\");\r\n\r\n  en = en.replace(\"piscina exterior con vistas al mar\", \"outdoor pool with sea view\");\r\n  en = en.replace(\"piscina al aire libre frente al oc√©ano\", \"outdoor pool facing the ocean\");\r\n\r\n  en = en.replace(\"piscina exterior iluminada al atardecer\", \"outdoor pool illuminated at sunset\");\r\n\r\n  en = en.replace(\"piscina exterior del hotel\", \"outdoor hotel pool\");\r\n  en = en.replace(\"piscina interior climatizada\", \"heated indoor pool\");\r\n  en = en.replace(\"piscina del hotel\", \"hotel swimming pool\");\r\n\r\n  // Spa avanzado\r\n  en = en.replace(\"sala de masajes con camillas preparadas\", \"massage room with prepared tables\");\r\n  en = en.replace(\"camillas de masaje en un spa acogedor\", \"massage tables in a cozy spa\");\r\n  en = en.replace(\"sala de tratamientos con iluminaci√≥n c√°lida\", \"treatment room with warm lighting\");\r\n  en = en.replace(\"zona de spa con camillas y toallas preparadas\", \"spa area with massage tables and prepared towels\");\r\n  en = en.replace(\"espacio de bienestar con camillas de masaje\", \"wellness area with massage tables\");\r\n  en = en.replace(\"sala de spa lista para tratamientos relajantes\", \"spa room ready for relaxing treatments\");\r\n\r\n  en = en.replace(\"spa con sauna y zona de relajaci√≥n\", \"spa with sauna and relaxation area\");\r\n  en = en.replace(\"spa con jacuzzi y camillas de masaje\", \"spa with jacuzzi and massage tables\");\r\n\r\n  // Restaurante\r\n  en = en.replace(\"restaurante con vistas al mar\", \"restaurant with sea view\");\r\n  en = en.replace(\"buffet del hotel\", \"hotel buffet\");\r\n  en = en.replace(\"restaurante con terraza exterior\", \"restaurant with outdoor terrace\");\r\n  en = en.replace(\"restaurante elegante del hotel\", \"elegant hotel restaurant\");\r\n\r\n  // Bar\r\n  en = en.replace(\"rooftop bar con vistas a la ciudad\", \"rooftop bar with city view\");\r\n  en = en.replace(\"rooftop bar del hotel\", \"hotel rooftop bar\");\r\n  en = en.replace(\"bar iluminado por la noche\", \"bar illuminated at night\");\r\n  en = en.replace(\"bar del hotel con ambiente moderno\", \"hotel bar with modern atmosphere\");\r\n\r\n  // Habitaciones\r\n  en = en.replace(\"habitaci√≥n con vistas al mar\", \"room with sea view\");\r\n  en = en.replace(\"habitaci√≥n con balc√≥n privado\", \"room with private balcony\");\r\n  en = en.replace(\"habitaci√≥n moderna y luminosa\", \"modern and bright room\");\r\n\r\n  // Zonas comunes\r\n  en = en.replace(\"lobby moderno del hotel\", \"modern hotel lobby\");\r\n  en = en.replace(\"zona com√∫n con ambiente acogedor\", \"common area with cozy atmosphere\");\r\n  en = en.replace(\"zona coworking del hotel\", \"hotel coworking area\");\r\n  en = en.replace(\"sala de reuniones moderna\", \"modern meeting room\");\r\n  en = en.replace(\"kids club del hotel\", \"hotel kids club\");\r\n\r\n  // Exterior\r\n  en = en.replace(\"fachada del hotel con vistas al mar\", \"hotel facade with sea view\");\r\n  en = en.replace(\"fachada exterior del hotel\", \"exterior facade of the hotel\");\r\n\r\n  en = en.replace(/\\s+/g, \" \").trim();\r\n  return en.charAt(0).toUpperCase() + en.slice(1);\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1203, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/achra/proyectos/app-hotel-nueva/src/lib/updateMediaAiTitle.ts"],"sourcesContent":["// src/lib/updateMediaAiTitle.ts\r\n\r\nimport { supabase } from \"@/lib/supabaseClient\";\r\nimport { generateAiTitleFromClip } from \"./generateAiTitleV2\";\r\n\r\n/**\r\n * Actualiza el campo ai_title de una imagen en la tabla media\r\n */\r\nexport async function updateMediaAiTitle(\r\n  mediaId: string,\r\n  imageUrl: string,\r\n  category?: string | null,\r\n  tags?: any[]   // ‚Üê A√ëADIDO\r\n) {\r\n  try {\r\n    console.log(\"üß† Generando t√≠tulo con CLIP para:\", imageUrl);\r\n    console.log(\"üè∑Ô∏è Tags recibidos:\", tags);\r\n\r\n    // ‚Üê A√ëADIDO: pasar tags al generador\r\n    const ai_title = await generateAiTitleFromClip(imageUrl, category, tags);\r\n\r\n    console.log(\"üè∑Ô∏è T√≠tulo generado:\", ai_title);\r\n\r\n    const { error } = await supabase\r\n      .from(\"media\")\r\n      .update({ ai_title })\r\n      .eq(\"id\", mediaId);\r\n\r\n    if (error) {\r\n      console.error(\"‚ùå Error actualizando ai_title:\", error);\r\n      return null;\r\n    }\r\n\r\n    console.log(`‚úÖ ai_title actualizado para media ${mediaId}`);\r\n    return ai_title;\r\n  } catch (err) {\r\n    console.error(\"‚ùå Error en updateMediaAiTitle:\", err);\r\n    return null;\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA,gCAAgC;AAEhC;AACA;;;AAKO,eAAe,mBACpB,OAAe,EACf,QAAgB,EAChB,QAAwB,EACxB,IAAY,AAAG,YAAY;;IAE3B,IAAI;QACF,QAAQ,GAAG,CAAC,sCAAsC;QAClD,QAAQ,GAAG,CAAC,uBAAuB;QAEnC,qCAAqC;QACrC,MAAM,WAAW,MAAM,IAAA,4JAAuB,EAAC,UAAU,UAAU;QAEnE,QAAQ,GAAG,CAAC,wBAAwB;QAEpC,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,0IAAQ,CAC7B,IAAI,CAAC,SACL,MAAM,CAAC;YAAE;QAAS,GAClB,EAAE,CAAC,MAAM;QAEZ,IAAI,OAAO;YACT,QAAQ,KAAK,CAAC,kCAAkC;YAChD,OAAO;QACT;QAEA,QAAQ,GAAG,CAAC,CAAC,kCAAkC,EAAE,SAAS;QAC1D,OAAO;IACT,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,kCAAkC;QAChD,OAAO;IACT;AACF"}},
    {"offset": {"line": 1238, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/achra/proyectos/app-hotel-nueva/src/app/api/upload/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\nimport { v2 as cloudinary } from 'cloudinary';\r\nimport { createClient } from '@supabase/supabase-js';\r\nimport { Buffer } from 'buffer';\r\nimport crypto from 'crypto';\r\nimport sharp from 'sharp';\r\n\r\nimport { analyzeImage } from '@/lib/ai';\r\nimport { detectCategory } from '@/utils/categoryMap';\r\n\r\n// ‚≠ê IMPORTANTE: importar el generador de t√≠tulos\r\nimport { updateMediaAiTitle } from '@/lib/updateMediaAiTitle';\r\n\r\n// ==================== VALIDACI√ìN ENV ====================\r\nif (!process.env.CLOUDINARY_CLOUD_NAME) throw new Error('‚ùå CLOUDINARY_CLOUD_NAME no est√° definido');\r\nif (!process.env.CLOUDINARY_API_KEY) throw new Error('‚ùå CLOUDINARY_API_KEY no est√° definido');\r\nif (!process.env.CLOUDINARY_API_SECRET) throw new Error('‚ùå CLOUDINARY_API_SECRET no est√° definido');\r\n\r\ncloudinary.config({\r\n  cloud_name: process.env.CLOUDINARY_CLOUD_NAME,\r\n  api_key: process.env.CLOUDINARY_API_KEY,\r\n  api_secret: process.env.CLOUDINARY_API_SECRET,\r\n});\r\n\r\n// ==================== SUPABASE ====================\r\nconst supabase = createClient(\r\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\r\n);\r\n\r\n// ==================== VERSIONES ====================\r\nconst IMAGE_SIZES = {\r\n  thumbnail: { width: 256, height: 144 },\r\n  small: { width: 800, height: 450 },\r\n  medium: { width: 1920, height: 1080 },\r\n  large: { width: 2880, height: 1620 },\r\n};\r\n\r\nexport async function POST(request: NextRequest) {\r\n  console.log('üöÄ POST /api/upload iniciado');\r\n\r\n  try {\r\n    const formData = await request.formData();\r\n    const file = formData.get('file') as File | null;\r\n    const hotelId = formData.get('hotel_id') as string | null;\r\n\r\n    console.log('üì• Datos recibidos:', {\r\n      hasFile: !!file,\r\n      hasHotelId: !!hotelId,\r\n      fileType: file?.type,\r\n      fileSize: file?.size,\r\n    });\r\n\r\n    if (!file || !(file instanceof File)) {\r\n      return NextResponse.json({ error: 'Archivo inv√°lido' }, { status: 400 });\r\n    }\r\n\r\n    if (!hotelId) {\r\n      return NextResponse.json({ error: 'Falta hotel_id' }, { status: 400 });\r\n    }\r\n\r\n    if (file.size > 5 * 1024 * 1024) {\r\n      return NextResponse.json({ error: 'Archivo demasiado grande (m√°x. 5MB)' }, { status: 400 });\r\n    }\r\n\r\n    // ==================== BUFFER + METADATA ====================\r\n    const arrayBuffer = await file.arrayBuffer();\r\n    const buffer = Buffer.from(arrayBuffer);\r\n\r\n    const metadata = await sharp(buffer).metadata();\r\n\r\n    // ==================== HASH ====================\r\n    const hash = crypto.createHash('sha256').update(buffer).digest('hex');\r\n    console.log('üîë Hash generado:', hash.substring(0, 16));\r\n\r\n    // ==================== CHECK DUPLICADO ====================\r\n    const { data: existing, error: checkError } = await supabase\r\n      .from('image_hashes')\r\n      .select('url, type, quality_score')\r\n      .eq('hash', hash)\r\n      .single();\r\n\r\n    if (checkError && checkError.code !== 'PGRST116') {\r\n      console.error('‚ùå Error verificando hash:', checkError);\r\n      return NextResponse.json({ error: 'Error verificando duplicados' }, { status: 500 });\r\n    }\r\n\r\n    // ==================== DUPLICADO ====================\r\n    if (existing) {\r\n      console.log('‚ö†Ô∏è Imagen duplicada detectada');\r\n\r\n      const analysis = await analyzeImage(existing.url);\r\n\r\n      const tags = analysis.tags;\r\n      const category = detectCategory(tags);\r\n\r\n      console.log('üè∑Ô∏è Tags (premium):', tags);\r\n      console.log('üìÇ Categor√≠a detectada:', category);\r\n\r\n      return NextResponse.json({\r\n        url: existing.url,\r\n        type: existing.type,\r\n        quality_score: existing.quality_score || 0.8,\r\n        is_duplicate: true,\r\n        tags,\r\n        category,\r\n        message: 'Esta imagen ya existe en tu galer√≠a',\r\n      });\r\n    }\r\n\r\n    // ==================== UPLOAD CLOUDINARY ====================\r\n    console.log('‚òÅÔ∏è Subiendo a Cloudinary...');\r\n\r\n    const uploadResult = await new Promise<any>((resolve, reject) => {\r\n      cloudinary.uploader\r\n        .upload_stream(\r\n          {\r\n            folder: 'hotel-media',\r\n            resource_type: 'auto',\r\n            invalidate: true,\r\n            quality_analysis: true,\r\n          },\r\n          (error, result) => {\r\n            if (error) reject(error);\r\n            else resolve(result);\r\n          }\r\n        )\r\n        .end(buffer);\r\n    });\r\n\r\n    console.log('‚úÖ Subida exitosa:', uploadResult.secure_url);\r\n\r\n    // ==================== IA ====================\r\n    console.log('üîç Analizando imagen con ExSabri IA...');\r\n    const analysis = await analyzeImage(uploadResult.secure_url);\r\n\r\n    const tags = analysis.tags;\r\n    const category = detectCategory(tags);\r\n\r\n    console.log('üè∑Ô∏è Tags (premium):', tags);\r\n    console.log('üìÇ Categor√≠a detectada:', category);\r\n\r\n    const qualityScore = uploadResult.quality_analysis?.focus || 0.8;\r\n\r\n    // ==================== GENERAR VERSIONES ====================\r\n    console.log('üîÑ Generando versiones de imagen...');\r\n\r\n    const versions: any = {};\r\n\r\n    versions.original = {\r\n      url: uploadResult.secure_url,\r\n      dimensions: `${metadata.width}x${metadata.height}`,\r\n      aspect_ratio:\r\n        metadata.width && metadata.height ? `${metadata.width}:${metadata.height}` : 'N/A',\r\n      file_size: `${(buffer.length / 1024).toFixed(1)}KB`,\r\n    };\r\n\r\n    for (const [sizeName, sizeConfig] of Object.entries(IMAGE_SIZES)) {\r\n      try {\r\n        console.log(`  üì∏ Procesando versi√≥n ${sizeName}...`);\r\n\r\n        const processedBuffer = await sharp(buffer)\r\n          .resize(sizeConfig.width, sizeConfig.height, {\r\n            fit: 'inside',\r\n            withoutEnlargement: true,\r\n          })\r\n          .jpeg({ quality: sizeName === 'thumbnail' ? 70 : 85 })\r\n          .toBuffer();\r\n\r\n        const versionUploadResult = await new Promise<any>((resolve, reject) => {\r\n          cloudinary.uploader\r\n            .upload_stream(\r\n              {\r\n                folder: 'hotel-media/versions',\r\n                resource_type: 'image',\r\n                invalidate: true,\r\n                public_id: `${sizeName}-${hash.substring(0, 16)}`,\r\n              },\r\n              (error, result) => {\r\n                if (error) reject(error);\r\n                else resolve(result);\r\n              }\r\n            )\r\n            .end(processedBuffer);\r\n        });\r\n\r\n        const versionMetadata = await sharp(processedBuffer).metadata();\r\n\r\n        versions[sizeName] = {\r\n          url: versionUploadResult.secure_url,\r\n          dimensions: `${versionMetadata.width}x${versionMetadata.height}`,\r\n          aspect_ratio:\r\n            versionMetadata.width && versionMetadata.height\r\n              ? `${versionMetadata.width}:${versionMetadata.height}`\r\n              : 'N/A',\r\n          file_size: `${(processedBuffer.length / 1024).toFixed(1)}KB`,\r\n        };\r\n\r\n        console.log(`  ‚úÖ Versi√≥n ${sizeName} generada: ${versionUploadResult.secure_url}`);\r\n      } catch (error) {\r\n        console.error(`  ‚ùå Error procesando ${sizeName}:`, error);\r\n        versions[sizeName] = versions.original;\r\n      }\r\n    }\r\n\r\n    console.log('‚úÖ Todas las versiones generadas');\r\n\r\n    // ==================== GUARDAR HASH ====================\r\n    const { error: insertHashError } = await supabase.from('image_hashes').insert({\r\n      hash,\r\n      url: uploadResult.secure_url,\r\n      type: uploadResult.resource_type,\r\n      quality_score: qualityScore,\r\n    });\r\n\r\n    if (insertHashError) {\r\n      console.error('‚ùå Error guardando hash:', insertHashError);\r\n    } else {\r\n      console.log('‚úÖ Hash guardado');\r\n    }\r\n\r\n    // ==================== GUARDAR MEDIA ====================\r\n    console.log('üíæ Guardando imagen en tabla media...');\r\n\r\n    const { data: photoData, error: photoError } = await supabase\r\n      .from('media')\r\n      .insert([\r\n        {\r\n          hotel_id: hotelId,\r\n          url: uploadResult.secure_url,\r\n          tags,\r\n          confidence_scores: tags,\r\n          quality_score: qualityScore,\r\n          hash,\r\n          category,\r\n          versions: JSON.stringify(versions),\r\n        },\r\n      ])\r\n      .select();\r\n\r\n    if (photoError) {\r\n      console.error('‚ùå Error guardando foto:', photoError);\r\n      throw new Error('Error al guardar foto en base de datos');\r\n    }\r\n\r\n    console.log('‚úÖ Foto guardada con ID:', photoData?.[0]?.id);\r\n\r\n    // ‚≠ê GENERAR T√çTULO AUTOM√ÅTICO CON CLIP\r\n    try {\r\n      console.log(\"üß† Generando t√≠tulo autom√°tico con CLIP...\");\r\n\r\n      // SOLO UNA LLAMADA ‚Äî CON TAGS\r\n      await updateMediaAiTitle(\r\n        photoData[0].id,\r\n        uploadResult.secure_url,\r\n        category,\r\n        tags\r\n      );\r\n\r\n      console.log(\"‚úÖ T√≠tulo generado y guardado\");\r\n    } catch (err) {\r\n      console.error(\"‚ùå Error generando t√≠tulo autom√°tico:\", err);\r\n    }\r\n\r\n    return NextResponse.json({\r\n      url: uploadResult.secure_url,\r\n      type: uploadResult.resource_type,\r\n      quality_score: qualityScore,\r\n      is_duplicate: false,\r\n      tags,\r\n      category,\r\n      photo_id: photoData?.[0]?.id,\r\n      versions,\r\n    });\r\n  } catch (error) {\r\n    console.error('‚ùå Error fatal en API:', error);\r\n    return NextResponse.json(\r\n      {\r\n        error: 'Error interno del servidor',\r\n        details: error instanceof Error ? error.message : String(error),\r\n      },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}}]
}